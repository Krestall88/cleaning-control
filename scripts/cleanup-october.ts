import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function cleanup() {
  console.log('üóëÔ∏è  –ù–∞—á–∏–Ω–∞–µ–º –æ—á–∏—Å—Ç–∫—É —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025...\n');
  
  try {
    // –£–¥–∞–ª—è–µ–º —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025
    console.log('üìä –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ (InventoryExpense)...');
    const deletedExpenses = await prisma.inventoryExpense.deleteMany({
      where: {
        month: 10,
        year: 2025
      }
    });
    console.log(`‚úÖ –£–¥–∞–ª–µ–Ω–æ —Ä–∞—Å—Ö–æ–¥–æ–≤: ${deletedExpenses.count}\n`);
    
    // –£–¥–∞–ª—è–µ–º –ª–∏–º–∏—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025
    console.log('üìä –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (ExpenseCategoryLimit)...');
    const deletedCategoryLimits = await prisma.expenseCategoryLimit.deleteMany({
      where: {
        month: 10,
        year: 2025,
        periodType: 'MONTHLY'
      }
    });
    console.log(`‚úÖ –£–¥–∞–ª–µ–Ω–æ –ª–∏–º–∏—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: ${deletedCategoryLimits.count}\n`);
    
    // –ü—Ä–æ–±—É–µ–º —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–∏–º–∏—Ç—ã (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    console.log('üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–∏–º–∏—Ç–æ–≤ (InventoryLimit)...');
    try {
      const deletedOldLimits = await (prisma as any).inventoryLimit.deleteMany({
        where: {
          month: 10,
          year: 2025
        }
      });
      console.log(`‚úÖ –£–¥–∞–ª–µ–Ω–æ —Å—Ç–∞—Ä—ã—Ö –ª–∏–º–∏—Ç–æ–≤: ${deletedOldLimits.count}\n`);
    } catch (e) {
      console.log('‚ÑπÔ∏è  –¢–∞–±–ª–∏—Ü–∞ InventoryLimit –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –ø—É—Å—Ç–∞\n');
    }
    
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log('‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
    console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
    console.log(`\nüìà –ò—Ç–æ–≥–æ —É–¥–∞–ª–µ–Ω–æ:`);
    console.log(`   - –†–∞—Å—Ö–æ–¥–æ–≤: ${deletedExpenses.count}`);
    console.log(`   - –õ–∏–º–∏—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: ${deletedCategoryLimits.count}`);
    
  } catch (error) {
    console.error('\n‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

// –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
console.log('‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –£–î–ê–õ–ï–ù–ò–ï –î–ê–ù–ù–´–• –ó–ê –û–ö–¢–Ø–ë–†–¨ 2025');
console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
console.log('–ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã:');
console.log('  - –í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025');
console.log('  - –í—Å–µ –ª–∏–º–∏—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025');
console.log('  - –°—Ç–∞—Ä—ã–µ –ª–∏–º–∏—Ç—ã –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025 (–µ—Å–ª–∏ –µ—Å—Ç—å)');
console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');

cleanup()
  .then(() => {
    console.log('\n‚úÖ –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ');
    process.exit(0);
  })
  .catch((error) => {
    console.error('\n‚ùå –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π');
    process.exit(1);
  });
