import json
import pandas as pd

# –ß–∏—Ç–∞–µ–º JSON
with open('objects-data.json', encoding='utf-8') as f:
    data = json.load(f)

df = pd.DataFrame(data)

print("=" * 80)
print("–ê–ù–ê–õ–ò–ó –°–¢–†–£–ö–¢–£–†–´ –î–ê–ù–ù–´–• –í EXCEL")
print("=" * 80)

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π
print("\nüìä –ó–ê–ü–û–õ–ù–ï–ù–ù–û–°–¢–¨ –ü–û–õ–ï–ô:\n")

fields = ['—É—á–∞—Å—Ç–æ–∫', '–∑–æ–Ω–∞', '–≥—Ä—É–ø–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏–π', '–ø–æ–º–µ—â–µ–Ω–∏–µ', '–û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏', '—Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ']
for field in fields:
    filled = df[field].notna().sum()
    percent = (filled / len(df)) * 100
    print(f"  {field:25} {filled:5} / {len(df)} ({percent:5.1f}%)")

print("\n" + "=" * 80)
print("–ü–†–ò–ú–ï–†–´ –î–ê–ù–ù–´–• –ü–û –û–ë–™–ï–ö–¢–ê–ú")
print("=" * 80)

# –Æ–≥-—Å–µ—Ä–≤–∏—Å
print("\nüè¢ –Æ–ì-–°–ï–†–í–ò–° (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n")
yug_data = df[df['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞'].str.contains('–Æ–≥-—Å–µ—Ä–≤–∏—Å', na=False)].head(5)
for idx, row in yug_data.iterrows():
    print(f"  –£—á–∞—Å—Ç–æ–∫: '{row['—É—á–∞—Å—Ç–æ–∫']}'")
    print(f"  –ó–æ–Ω–∞: '{row['–∑–æ–Ω–∞']}'")
    print(f"  –ì—Ä—É–ø–ø–∞: '{row['–≥—Ä—É–ø–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏–π']}'")
    print(f"  –ü–æ–º–µ—â–µ–Ω–∏–µ: '{row['–ø–æ–º–µ—â–µ–Ω–∏–µ']}'")
    print(f"  –û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏: '{row['–û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏']}'")
    print(f"  –¢–µ—Ö –∑–∞–¥–∞–Ω–∏–µ: '{str(row['—Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ'])[:60]}...'")
    print()

# –ü–µ–ø—Å–∏–ö–æ
print("\nüè¢ –ü–ï–ü–°–ò–ö–û (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n")
pepsi_data = df[df['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞'].str.contains('–ü–µ–ø—Å–∏–ö–æ', na=False)].head(5)
for idx, row in pepsi_data.iterrows():
    print(f"  –£—á–∞—Å—Ç–æ–∫: '{row['—É—á–∞—Å—Ç–æ–∫']}'")
    print(f"  –ó–æ–Ω–∞: '{row['–∑–æ–Ω–∞']}'")
    print(f"  –ì—Ä—É–ø–ø–∞: '{row['–≥—Ä—É–ø–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏–π']}'")
    print(f"  –ü–æ–º–µ—â–µ–Ω–∏–µ: '{row['–ø–æ–º–µ—â–µ–Ω–∏–µ']}'")
    print(f"  –û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏: '{row['–û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏']}'")
    print(f"  –¢–µ—Ö –∑–∞–¥–∞–Ω–∏–µ: '{str(row['—Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ'])[:60]}...'")
    print()

# –≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç
print("\nüè¢ –≠–õ–ï–ö–¢–†–û–©–ò–¢ (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n")
electro_data = df[df['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞'].str.contains('–≠–ª–µ–∫—Ç—Ä–æ—â–∏—Ç', na=False)].head(5)
for idx, row in electro_data.iterrows():
    print(f"  –£—á–∞—Å—Ç–æ–∫: '{row['—É—á–∞—Å—Ç–æ–∫']}'")
    print(f"  –ó–æ–Ω–∞: '{row['–∑–æ–Ω–∞']}'")
    print(f"  –ì—Ä—É–ø–ø–∞: '{row['–≥—Ä—É–ø–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏–π']}'")
    print(f"  –ü–æ–º–µ—â–µ–Ω–∏–µ: '{row['–ø–æ–º–µ—â–µ–Ω–∏–µ']}'")
    print(f"  –û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏: '{row['–û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏']}'")
    print(f"  –¢–µ—Ö –∑–∞–¥–∞–Ω–∏–µ: '{str(row['—Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ'])[:60]}...'")
    print()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º –ø–æ–ª–µ–π
print("\n" + "=" * 80)
print("–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –ö–û–ú–ë–ò–ù–ê–¶–ò–Ø–ú –ò–ï–†–ê–†–•–ò–ò")
print("=" * 80 + "\n")

# –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
has_site = df['—É—á–∞—Å—Ç–æ–∫'].notna()
has_zone = df['–∑–æ–Ω–∞'].notna()
has_group = df['–≥—Ä—É–ø–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏–π'].notna()
has_room = df['–ø–æ–º–µ—â–µ–Ω–∏–µ'].notna()
has_item = df['–û–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏'].notna()
has_tech = df['—Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ'].notna()

print(f"–¢–æ–ª—å–∫–æ —Ç–µ—Ö –∑–∞–¥–∞–Ω–∏–µ (–±–µ–∑ –∏–µ—Ä–∞—Ä—Ö–∏–∏): {(has_tech & ~has_site & ~has_zone & ~has_group & ~has_room & ~has_item).sum()}")
print(f"–¢–µ—Ö –∑–∞–¥–∞–Ω–∏–µ + –ø–æ–º–µ—â–µ–Ω–∏–µ: {(has_tech & has_room & ~has_group & ~has_zone & ~has_site).sum()}")
print(f"–¢–µ—Ö –∑–∞–¥–∞–Ω–∏–µ + –ø–æ–º–µ—â–µ–Ω–∏–µ + –æ–±—ä–µ–∫—Ç —É–±–æ—Ä–∫–∏: {(has_tech & has_room & has_item & ~has_group & ~has_zone & ~has_site).sum()}")
print(f"–ü–æ–ª–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è (—É—á–∞—Å—Ç–æ–∫ + –∑–æ–Ω–∞ + –≥—Ä—É–ø–ø–∞ + –ø–æ–º–µ—â–µ–Ω–∏–µ + –æ–±—ä–µ–∫—Ç + —Ç–µ—Ö): {(has_site & has_zone & has_group & has_room & has_item & has_tech).sum()}")
print(f"–£—á–∞—Å—Ç–æ–∫ + –∑–æ–Ω–∞ + –≥—Ä—É–ø–ø–∞ + –ø–æ–º–µ—â–µ–Ω–∏–µ + —Ç–µ—Ö (–±–µ–∑ –æ–±—ä–µ–∫—Ç–∞ —É–±–æ—Ä–∫–∏): {(has_site & has_zone & has_group & has_room & has_tech & ~has_item).sum()}")
print(f"–£—á–∞—Å—Ç–æ–∫ + –ø–æ–º–µ—â–µ–Ω–∏–µ + —Ç–µ—Ö (–±–µ–∑ –∑–æ–Ω—ã –∏ –≥—Ä—É–ø–ø—ã): {(has_site & has_room & has_tech & ~has_zone & ~has_group).sum()}")

print("\n" + "=" * 80)
