import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ¿Ð¸ÑÐºÐ°
const assignments = [
  { object: 'Â«Ð–ÐµÐ»Ð´Ð¾Ñ€Ð¿Ñ€Ð¾ÐµÐºÑ‚ ÐŸÐ¾Ð²Ð¾Ð»Ð¶ÑŒÑÂ»', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'ÐÐž "Ð¢ÑÐ¶Ð¼Ð°Ñˆ"', manager: 'Ð¢Ð¸Ð¼Ð¾Ñ…Ð¸Ð½Ð° ÐÐ½Ð½Ð° ÐÐ½Ð°Ñ‚Ð¾Ð»ÑŒÐµÐ²Ð½Ð°', phone: '89198030999', senior: 'Ð“Ð°Ð¹Ð½ÑƒÐ»Ð»Ð¸Ð½Ð° ÐÐ¹Ð½Ð° ÐÐ»Ð¸ÐµÐ²Ð½Ð°', seniorPhone: '89371841382' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð·Ð´Ð°Ð½Ð¸Ðµ Ð—Ð°Ð²Ð¾Ð´Ð¾ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ', manager: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89277576436' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°', manager: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89277576436' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'ÐŸÐ›ÐžÐ©ÐÐ”ÐšÐ Â«Ð Ð£Ð¡Ð¡ÐšÐ˜Ð™ Ð¢Ð ÐÐÐ¡Ð¤ÐžÐ ÐœÐÐ¢ÐžÐ Â»', manager: 'Ð“Ð°Ð¹Ð½ÑƒÐ»Ð»Ð¸Ð½Ð° ÐÐ¹Ð½Ð° ÐÐ»Ð¸ÐµÐ²Ð½Ð°', phone: '89371841382' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'ÐŸÐ›ÐžÐ©ÐÐ”ÐšÐ ÐšÐ ÐÐ¡ÐÐÐ¯ Ð“Ð›Ð˜ÐÐšÐ', manager: 'Ð“Ð°Ð¹Ð½ÑƒÐ»Ð»Ð¸Ð½Ð° ÐÐ¹Ð½Ð° ÐÐ»Ð¸ÐµÐ²Ð½Ð°', phone: '89371841382' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'Ð¿Ð¾Ð¼ÐµÑ‰ÐµÐ½Ð¸Ðµ ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð·Ð´Ð°Ð½Ð¸Ñ', manager: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89277576436' },
  { object: 'ÐÐž Â«Ð“Ðš Â«Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚Â» -Ð¢Ðœ Ð¡Ð°Ð¼Ð°Ñ€Ð°Â»', site: 'ÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑ Â«Ð­Ð½ÐµÑ€Ð³Ð¸ÑÂ»', manager: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89277576436' },
  { object: 'Ð—ÐÐž  Â«Ð¡Ð‘ÐšÐšÂ»', manager: 'Ð¡Ð¾ÐºÐ¾Ð»Ð¾Ð²Ð° ÐžÐ»ÑŒÐ³Ð° ÐšÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½Ð¾Ð²Ð½Ð°', phone: '89170173062' },
  { object: 'Ð˜ÐŸ Ð¨Ð¸Ñ€Ð¾ÐºÐ¾Ð² Ð”Ð¼Ð¸Ñ‚Ñ€Ð¸Ð¹ Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð¸Ñ‡', manager: 'Ð¨Ñ‚ÐµÐ»ÑŒÐ¼Ð°ÑˆÐµÐ½ÐºÐ¾ Ð˜Ñ€Ð¸Ð½Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89272618137' },
  { object: 'ÐœÐ‘Ð£ Â«Ð›Ð¾Ð¿Ð°Ñ‚Ð¸Ð½ÑÐºÐ¾ÐµÂ»', manager: 'Ð¨Ñ‚ÐµÐ»ÑŒÐ¼Ð°ÑˆÐµÐ½ÐºÐ¾ Ð˜Ñ€Ð¸Ð½Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89272618137' },
  { object: 'ÐžÐÐž "Ð¡Ð°Ð¼Ð°Ñ€ÑÐºÐ¸Ð¹ Ñ…Ð»ÐµÐ±Ð¾Ð·Ð°Ð²Ð¾Ð´ â„–5"', manager: 'ÐÐ°Ð¿Ð¾Ð»ÑŒÑÐºÐ°Ñ Ð›ÑŽÐ´Ð¼Ð¸Ð»Ð° ÐŸÐµÑ‚Ñ€Ð¾Ð²Ð½Ð°', phone: '89370715422' },
  { object: 'ÐžÐžÐž "42"', manager: 'ÐŸÐ»ÐµÐ½ÐºÐ¸Ð½Ð° ÐÐ°Ñ‚Ð°Ð»ÑŒÑ ÐÐ»ÐµÐºÑÐµÐµÐ²Ð½Ð°', phone: '89874416835' },
  { object: 'ÐžÐžÐž "Ð–Ð¸Ð»Ð­Ð½ÐµÑ€Ð³Ð¾"', site: 'ÐœÐµÑÑ‚Ð° Ð¾Ð±Ñ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ', manager: 'Ð“Ð°Ð»Ð¸ÐµÐ² Ð ÑƒÑÑ‚Ð°Ð¼ Ð Ð°Ñ„Ð¸ÐºÐ¾Ð²Ð¸Ñ‡', phone: '89677228013' },
  { object: 'ÐžÐžÐž "Ð–Ð¸Ð»Ð­Ð½ÐµÑ€Ð³Ð¾"', site: 'ÐŸÑ€Ð¸Ð´Ð¾Ð¼Ð¾Ð²Ð°Ñ Ñ‚ÐµÑ€Ñ€Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'ÐžÐžÐž "ÐœÐµÐ´Ð¸Ñ†Ð¸Ð½Ð°-ÐÐ»ÑŒÑ„Ð°Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ñ"', manager: 'ÐšÐ¾Ð·ÑŽÐ»Ð¸Ð½Ð° ÐÐ»Ð»Ð° Ð“ÐµÐ½Ð½Ð°Ð´ÑŒÐµÐ²Ð½Ð°', phone: '89879499241' },
  { object: 'ÐžÐžÐž "ÐŸÐš Ð¤Ð°Ñ€Ð¸ÐºÐ° ÐšÐ°Ñ‡ÐµÑÑ‚Ð²Ð°"', manager: 'ÐšÑ€Ð°Ð¿Ð¸Ð²ÐºÐ¾ Ð›Ð°Ñ€Ð¸ÑÐ° Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð½Ð°', phone: '89879873566', senior: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', seniorPhone: '89277576436' },
  { object: 'ÐžÐžÐž Â«ÐœÐ°Ñ€ÐºÐµÑ‚.ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¸Â» (Ð¯Ð½Ð´ÐµÐºÑ)', manager: 'Ð“Ð¾Ñ€Ð´ÐµÐµÐ² Ð Ð¾Ð¼Ð°Ð½ Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89879551196', senior: 'Ð¨Ñ‚ÐµÐ»ÑŒÐ¼Ð°ÑˆÐµÐ½ÐºÐ¾ Ð˜Ñ€Ð¸Ð½Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', seniorPhone: '89272618137' },
  { object: 'ÐžÐžÐž Â«ÐÐµÐºÑ‚Ð°Ñ€Â»', manager: 'Ð‘Ð¾Ð±Ñ€Ð¾Ð²ÑÐºÐ°Ñ Ð•Ð»ÐµÐ½Ð° Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð½Ð°', phone: '89379949424' },
  { object: 'ÐžÐžÐž Â«ÐÐ› ÐšÐ¾Ð½Ñ‚Ð¸Ð½ÐµÐ½Ñ‚Â»', manager: 'ÐŸÐ»ÐµÐ½ÐºÐ¸Ð½Ð° ÐÐ°Ñ‚Ð°Ð»ÑŒÑ ÐÐ»ÐµÐºÑÐµÐµÐ²Ð½Ð°', phone: '89874416835' },
  { object: 'ÐžÐžÐž Â«ÐŸÐµÐ¿ÑÐ¸ÐšÐ¾ Ð¥Ð¾Ð»Ð´Ð¸Ð½Ð³ÑÂ»', manager: 'Ð›Ð°ÑÐºÐ¸Ð½ ÐŸÐ°Ð²ÐµÐ» ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277570553', senior: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', seniorPhone: '89277576436' },
  { object: 'ÐžÐžÐž Â«Ð£Ðš Â«ÐÐ¼Ð¾Ð½Ð´-Ð–Ð¸Ð»ÐšÐ¾Ð¼Ð¡ÐµÑ€Ð²Ð¸ÑÂ»', manager: 'Ð‘ÑƒÐ´ÐºÐ¾Ð²Ð° Ð¡Ð²ÐµÑ‚Ð»Ð°Ð½Ð° Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð¾Ð²Ð½Ð°', phone: '89277406883' },
  { object: 'ÐžÐžÐž Ð§ÐžÐž Â«Ð“Ð²Ð°Ñ€Ð´ÐµÐµÑ†Â»', manager: 'Ð“Ð°Ð¹Ð½ÑƒÐ»Ð»Ð¸Ð½Ð° ÐÐ¹Ð½Ð° ÐÐ»Ð¸ÐµÐ²Ð½Ð°', phone: '89371841382' },
  { object: 'ÐŸÐÐž "Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ð‘Ð°Ð½Ðº"', manager: 'ÐšÐ¾Ð·ÑŽÐ»Ð¸Ð½Ð° ÐÐ»Ð»Ð° Ð“ÐµÐ½Ð½Ð°Ð´ÑŒÐµÐ²Ð½Ð°', phone: '89879499241' },
  { object: 'ÐŸÐÐž Â«Ð¡Ð°Ð¼Ð°Ñ€Ð°ÑÐ½ÐµÑ€Ð³Ð¾Â»', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'Ð¢Ð¡Ð– "Ð¡Ð¿Ð°Ñ€Ñ‚Ð°Ðº"', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'Ð£Ð¤ÐŸÐ¡Ðž ÑÐ°Ð½Ð°Ñ‚Ð¾Ñ€Ð¸Ð¹ Â«ÐšÑ€Ð°ÑÐ½Ð°Ñ Ð“Ð»Ð¸Ð½ÐºÐ°Â»', manager: 'Ð˜ÑÐ°Ð¹Ñ‡ÐµÐ²Ð° ÐœÐ°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð° ÐÐ¸ÐºÐ¾Ð»Ð°ÐµÐ²Ð½Ð°', phone: '89277576436' },
  { object: 'Ð¤Ð“Ð‘ÐžÐ£ Ð’Ðž Ð¡Ð°Ð¼Ð“ÐœÐ£ ÐœÐ¸Ð½Ð·Ð´Ñ€Ð°Ð²Ð° Ð Ð¾ÑÑÐ¸Ð¸', manager: 'Ð“Ð°Ð»Ð¸ÐµÐ² Ð ÑƒÑÑ‚Ð°Ð¼ Ð Ð°Ñ„Ð¸ÐºÐ¾Ð²Ð¸Ñ‡', phone: '89677228013' },
  { object: 'ÐžÐžÐž Ð£Ðš Ð‘Ð˜Ð“-Ð‘Ð•Ð', manager: 'ÐŸÐ»ÐµÐ½ÐºÐ¸Ð½Ð° ÐÐ°Ñ‚Ð°Ð»ÑŒÑ ÐÐ»ÐµÐºÑÐµÐµÐ²Ð½Ð°', phone: '89874416835' },
  { object: 'ÐžÐžÐž "Ð¤Ð›ÐÐ“ÐœÐÐ"', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'ÐžÐžÐž "Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ñ‰Ð¸Ñ‚-Ð˜Ð½Ð¶Ð¸Ð½Ð¸Ñ€Ð¸Ð½Ð³"', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'ÐžÐžÐž Â«ÐÐ»ÑŒÑ„Ð°Â» (Ð¢Ð¦ ÐœÐµÐ»Ð¾Ð´Ð¸Ñ)', manager: 'ÐšÐ¾Ð·ÑŽÐ»Ð¸Ð½Ð° ÐÐ»Ð»Ð° Ð“ÐµÐ½Ð½Ð°Ð´ÑŒÐµÐ²Ð½Ð°', phone: '89879499241' },
  { object: 'ÐžÐžÐž Â«Ð•Ð´Ð¸Ð½Ñ‹Ðµ Ð¢Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð½Ñ‹Ðµ Ð­Ð½ÐµÑ€Ð³Ð¾Ð¡Ð¸ÑÑ‚ÐµÐ¼Ñ‹Â»', manager: 'Ð’Ð°ÑÐµÐºÐ¸Ð½ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð¸Ñ‡', phone: '89277165189' },
  { object: 'ÐžÐžÐž Â«Ð˜Ð½ÐºÐ°Ñ‚ÐµÑ…Â»', manager: 'ÐšÐ¾Ð±Ð·ÐµÐ²Ð° ÐÐ½Ð½Ð° Ð’ÑÑ‡ÐµÑÐ»Ð°Ð²Ð¾Ð²Ð½Ð°', phone: '89279035948', senior: 'ÐÑƒÐ²Ð°Ð»ÑŒÑ†ÐµÐ²Ð° ÐœÐ°Ñ€Ð¸Ñ ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²Ð½Ð°', seniorPhone: '89179582793' }
];

async function main() {
  console.log('ðŸ”§ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð²...\n');
  console.log(`Ð’ÑÐµÐ³Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸: ${assignments.length}\n`);

  let updated = 0;
  let errors = 0;

  for (const assignment of assignments) {
    try {
      console.log(`\nðŸ“¦ ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°: ${assignment.object}${assignment.site ? ` / ${assignment.site}` : ''}`);
      console.log(`   ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€: ${assignment.manager}`);

      // ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°
      const manager = await prisma.user.findFirst({
        where: {
          OR: [
            { name: { contains: assignment.manager, mode: 'insensitive' } },
            { phone: assignment.phone }
          ],
          role: { in: ['MANAGER', 'SENIOR_MANAGER'] }
        }
      });

      if (!manager) {
        console.log(`   âš ï¸  ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: ${assignment.manager}`);
        errors++;
        continue;
      }

      console.log(`   âœ… ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð½Ð°Ð¹Ð´ÐµÐ½: ${manager.name} (${manager.email})`);

      // Ð•ÑÐ»Ð¸ ÑÑ‚Ð¾ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð° ÑƒÑ‡Ð°ÑÑ‚Ð¾Ðº
      if (assignment.site) {
        // ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð¾Ð±ÑŠÐµÐºÑ‚
        const object = await prisma.cleaningObject.findFirst({
          where: {
            name: { contains: assignment.object, mode: 'insensitive' }
          }
        });

        if (!object) {
          console.log(`   âš ï¸  ÐžÐ±ÑŠÐµÐºÑ‚ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: ${assignment.object}`);
          errors++;
          continue;
        }

        // ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ ÑƒÑ‡Ð°ÑÑ‚Ð¾Ðº
        const site = await prisma.site.findFirst({
          where: {
            objectId: object.id,
            name: { contains: assignment.site, mode: 'insensitive' }
          }
        });

        if (!site) {
          console.log(`   âš ï¸  Ð£Ñ‡Ð°ÑÑ‚Ð¾Ðº Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: ${assignment.site}`);
          errors++;
          continue;
        }

        // ÐÐ°Ð·Ð½Ð°Ñ‡Ð°ÐµÐ¼ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð° Ð½Ð° ÑƒÑ‡Ð°ÑÑ‚Ð¾Ðº
        await prisma.site.update({
          where: { id: site.id },
          data: { managerId: manager.id }
        });

        console.log(`   âœ… ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ð½Ð° ÑƒÑ‡Ð°ÑÑ‚Ð¾Ðº`);
        updated++;
      } else {
        // ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð½Ð° Ð²ÐµÑÑŒ Ð¾Ð±ÑŠÐµÐºÑ‚
        const object = await prisma.cleaningObject.findFirst({
          where: {
            name: { contains: assignment.object, mode: 'insensitive' }
          }
        });

        if (!object) {
          console.log(`   âš ï¸  ÐžÐ±ÑŠÐµÐºÑ‚ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: ${assignment.object}`);
          errors++;
          continue;
        }

        // ÐÐ°Ð·Ð½Ð°Ñ‡Ð°ÐµÐ¼ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð° Ð½Ð° Ð¾Ð±ÑŠÐµÐºÑ‚
        await prisma.cleaningObject.update({
          where: { id: object.id },
          data: { managerId: manager.id }
        });

        console.log(`   âœ… ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ð½Ð° Ð¾Ð±ÑŠÐµÐºÑ‚`);
        updated++;
      }

    } catch (error) {
      console.error(`   âŒ ÐžÑˆÐ¸Ð±ÐºÐ°:`, error);
      errors++;
    }
  }

  console.log(`\n${'='.repeat(80)}`);
  console.log(`âœ… ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°`);
  console.log(`   Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾: ${updated}`);
  console.log(`   ÐžÑˆÐ¸Ð±Ð¾Ðº: ${errors}`);
  console.log('='.repeat(80));
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
