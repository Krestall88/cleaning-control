import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// –ú–∞–ø–ø–∏–Ω–≥ –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏
const frequencyMapping: Record<string, string> = {
  // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ
  'DAILY': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–µ–∂–µ–¥–Ω–µ–≤–Ω–æ': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–∫–∞–∂–¥—ã–π –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–ö–∞–∂–¥—ã–π –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '1 —Ä–∞–∑ –≤ –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '1—Ä–∞–∑ –≤ –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–µ–∂–µ–¥–Ω–µ–≤–Ω–æ (1—Ä–∞–∑ –≤ –¥–µ–Ω—å)': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '–µ–∂–µ–¥–Ω–µ–≤–Ω–æ (1 —Ä–∞–∑ –≤ –¥–µ–Ω—å)': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '1—Ä–∞–∑ –≤ –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  
  // –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ
  'WEEKLY': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (–≤ —Å—Ä–µ–¥—É)': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (–ø—è—Ç–Ω–∏—Ü–∞)': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –≤—Ç': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –í–¢': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  
  // 2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é
  '2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é': '2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  '2 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é': '2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  '2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é –≤—Ç –∏ —á—Ç': '2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  
  // 3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é
  '3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é': '3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  '3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é': '3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  '3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é': '3-4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é',
  
  // 5 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
  '5 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é': '5 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é',
  '5 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é': '5 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é',
  
  // –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ
  'MONTHLY': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '–ï–∂–µ–º–µ—Å—è—á–Ω–æ': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '–µ–∂–µ–º–µ—Å—è—á–Ω–æ': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü (–ü—Ç)': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü (–ø—Ç)': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü (–ü–¢)': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  '1—Ä–∞–∑ –≤ –º–µ—Å—è—Ü –∏ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ',
  
  // 4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü
  '4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü': '4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü',
  '4 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü': '4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü',
  '4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü (–ø–Ω)': '4 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü',
  
  // 2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å
  '2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å': '2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å',
  '2 —Ä–∞–∑ –≤ –¥–µ–Ω—å': '2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å',
  '1—Ä–∞–∑ –≤ –¥–µ–Ω—å': '2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å',
  
  // 3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å
  '3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å': '3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å',
  '–° –ü–Ω –ø–æ –í—Å 3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å{ –°–∞–Ω–ü–∏–ù 2.1.3684-21)': '3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å',
  
  // 2 —Ä–∞–∑–∞ –≤ –≥–æ–¥
  '2 —Ä–∞–∑–∞ –≤ –≥–æ–¥': '2 —Ä–∞–∑–∞ –≤ –≥–æ–¥',
  '2 —Ä–∞–∑ –≤ –≥–æ–¥': '2 —Ä–∞–∑–∞ –≤ –≥–æ–¥',
  
  // –° –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü—É
  '—Å –ü–Ω –ø–æ –ü—Ç 2—Ä–∞–∑–∞ –≤ –¥–µ–Ω—å': '–° –ü–Ω –ø–æ –ü—Ç (2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å)',
  '—Å –ü–Ω –ø–æ –ü—Ç (2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é)': '–° –ü–Ω –ø–æ –ü—Ç (2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é)',
  '—Å –ü–Ω –ø–æ –ü—Ç 1 —Ä–∞–∑ –≤ –¥–µ–Ω—å': '–° –ü–Ω –ø–æ –ü—Ç (1 —Ä–∞–∑ –≤ –¥–µ–Ω—å)',
  '—Å –ü–Ω –ø–æ –í—Å 1 —Ä–∞–∑ –≤ –¥–µ–Ω—å': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  
  // –°—É–±–±–æ—Ç–∞ –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
  '–°—É–±–±–æ—Ç–∞ –∏ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 1 —Ä–∞–∑': '–°—É–±–±–æ—Ç–∞ –∏ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ (1 —Ä–∞–∑)',
  
  // –ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
  '–ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏': '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏',
  '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏': '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏',
  '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –Ω–æ –Ω–µ —Ä–µ–∂–µ 1 —Ä–∞–∑–∞ –≤ 2 —Å—É—Ç–æ–∫': '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏',
  '–ü–æ –º–µ—Ä–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è': '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏',
  '1—Ä–∞–∑ –≤ –º–µ—Å—è—Ü –∏ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏': '–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏',
  
  // –ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ
  '–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ': '–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª': '–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ',
  '1 —Ä–∞–∑ –≤ 3 –º–µ—Å—è—Ü–∞': '–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ',
  
  // –î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
  '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
  '1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (–ª–æ–∫–∞–ª—å–Ω–æ)': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '—Å –ü–Ω –ø–æ –ü—Ç –Ω–∞ –≤—ã—Å–æ—Ç–µ 2,0 –º.( 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)': '–° –ü–Ω –ø–æ –ü—Ç (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)',
  '–í—Ç–æ—Ä–Ω–∏–∫ –Ω–∞ –≤—ã—Å–æ—Ç–µ 2,0 –º.( 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
  '–í—Ç–æ—Ä–Ω–∏–∫ –Ω–∞ –≤—ã—Å–æ—Ç–µ 2,0 –º.( 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é, –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
};

async function unifyFrequency() {
  try {
    console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏...\n');

    let totalUpdated = 0;
    const stats: Record<string, number> = {};

    for (const [oldFreq, newFreq] of Object.entries(frequencyMapping)) {
      const result = await prisma.techCard.updateMany({
        where: { frequency: oldFreq },
        data: { frequency: newFreq }
      });

      if (result.count > 0) {
        console.log(`‚úÖ "${oldFreq}" ‚Üí "${newFreq}": ${result.count} —Ç–µ—Ö–∫–∞—Ä—Ç`);
        totalUpdated += result.count;
        stats[newFreq] = (stats[newFreq] || 0) + result.count;
      }
    }

    console.log('\n' + '='.repeat(60));
    console.log('üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:');
    console.log('='.repeat(60));
    console.log(`‚úÖ –í—Å–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: ${totalUpdated} —Ç–µ—Ö–∫–∞—Ä—Ç\n`);
    
    console.log('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º:');
    Object.entries(stats)
      .sort((a, b) => b[1] - a[1])
      .forEach(([freq, count]) => {
        console.log(`  ${freq}: ${count} —Ç–µ—Ö–∫–∞—Ä—Ç`);
      });

    console.log('\n‚úÖ –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');

  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

unifyFrequency()
  .then(() => process.exit(0))
  .catch(() => process.exit(1));
