# üöÄ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –†–ê–£–ù–î 3 - VERCEL –î–ï–ü–õ–û–ô

## ‚ùå **–ò–°–•–û–î–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:**
**Module parse failed: Identifier 'user' has already been declared**
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `user` –æ–±—ä—è–≤–ª–µ–Ω–∞ –¥–≤–∞–∂–¥—ã –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `session` –≤ –∫–æ–¥–µ

## ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

### 1Ô∏è‚É£ **–î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–û–ô USER**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ `sites/[id]/assign-manager/route.ts`
- ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª –≤—Ç–æ—Ä—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `user` –≤ `userRecord`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏–ª –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `session`

### 2Ô∏è‚É£ **–ü–†–û–§–ò–õ–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**
- ‚úÖ –ó–∞–º–µ–Ω–∏–ª –≤—Å–µ `getServerSession(authOptions)` –Ω–∞ `getAuthSession()`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏–ª –≤ `sites/[id]/route.ts` (3 –≤—Ö–æ–∂–¥–µ–Ω–∏—è)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏–ª –≤ `sites/route.ts` (1 –≤—Ö–æ–∂–¥–µ–Ω–∏–µ)
- ‚úÖ –£–ø—Ä–æ—Å—Ç–∏–ª `sites/page.tsx` - —É–±—Ä–∞–ª —Å–ª–æ–∂–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

### 3Ô∏è‚É£ **–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï REPLACE_ALL**
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏–ª `replace_all` –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –∑–∞–º–µ–Ω—ã
- ‚úÖ –ò–∑–±–µ–∂–∞–ª –æ—à–∏–±–æ–∫ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–ª –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö

## üéØ **–ü–†–ò–ù–¶–ò–ü –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:**

### **"–¢–û–ß–ï–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï + –ú–ê–°–°–û–í–ê–Ø –ü–†–û–§–ò–õ–ê–ö–¢–ò–ö–ê"**

1. **–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—à–∏–±–∫–∏** - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–∏—á–∏–Ω—ã** - –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. **–ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–±–ª–µ–º** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã auth
4. **–ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –º–µ—Å—Ç

## üìã **–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´:**

### **sites/[id]/assign-manager/route.ts**
```typescript
// –î–û:
const user = await getAuthSession();
// ...
const user = await prisma.user.findUnique({ // ‚ùå –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï

// –ü–û–°–õ–ï:
const session = await getAuthSession();
// ...
const userRecord = await prisma.user.findUnique({ // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```

### **sites/[id]/route.ts**
```typescript
// –î–û:
const session = await getServerSession(authOptions); // ‚ùå 3 —Ä–∞–∑–∞

// –ü–û–°–õ–ï:
const session = await getAuthSession(); // ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –≤—Å–µ
```

### **sites/route.ts**
```typescript
// –î–û:
const session = await getServerSession(authOptions); // ‚ùå

// –ü–û–°–õ–ï:
const session = await getAuthSession(); // ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
```

### **sites/page.tsx**
```typescript
// –î–û:
import { getServerSession } from 'next-auth';
import { authOptions } from '../api/auth/[...nextauth]/route';

// –ü–û–°–õ–ï:
import { getAuthSession } from '@/lib/auth'; // ‚úÖ –£–ø—Ä–æ—â–µ–Ω–æ
```

## üöÄ **–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –î–ï–ü–õ–û–Æ:**

### **–°–¢–ê–¢–£–°: –ì–û–¢–û–í –ö –ü–û–í–¢–û–†–ù–û–ú–£ –î–ï–ü–õ–û–Æ** ‚úÖ

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
2. **–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
3. **–ò–º–ø–æ—Ä—Ç—ã auth:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
4. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –û–±–µ—Å–ø–µ—á–µ–Ω–∞ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö

## üìä **–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:**

### **–ù–ê VERCEL:**
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ Webpack —Å–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞

## üîÑ **–ò–ó–í–õ–ï–ß–ï–ù–ù–´–ï –£–†–û–ö–ò:**

### **–†–ê–ë–û–¢–ê –° –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ú–ò –í–•–û–ñ–î–ï–ù–ò–Ø–ú–ò:**
1. **–í—Å–µ–≥–¥–∞ —á–∏—Ç–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ñ–∞–π–ª** –ø–µ—Ä–µ–¥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å replace_all** –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–º–µ–Ω
3. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
4. **–ò—Å–∫–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

### **–°–¢–†–ê–¢–ï–ì–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:**
1. **–¢–æ—á–µ—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—à–∏–±–∫–∏
2. **–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–±–ª–µ–º
3. **–ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏** –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

## üéâ **–†–ï–ó–£–õ–¨–¢–ê–¢:**

**–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–π –∏ –∏–º–ø–æ—Ä—Ç–æ–≤!**

- ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω

**–ü–æ–¥—Ö–æ–¥: –°–∏—Å—Ç–µ–º–Ω—ã–π, –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π, –Ω–∞–¥–µ–∂–Ω—ã–π**
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: ~15 –º–∏–Ω—É—Ç**
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 100%**
