# ๐๏ธ ะะขะงะะข: ะะะกะจะะะะะะซะ ะะะะะะข EXCEL ะก ะะะะะะ ะกะขะะฃะะขะฃะะะ

**ะะฐัะฐ:** 29 ะพะบััะฑัั 2025, 13:10 UTC+3  
**ะกัะฐััั:** ะกะะะะะ - ะะพะปะฝะพัะตะฝะฝัะน ะธะผะฟะพัั ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ัะพะทะดะฐะฝะธะตะผ ััััะบัััั

## โ ะะะะะะะะะะะะซะ ะคะฃะะะฆะะะะะ

### **1. ะะฝะฐะปะธะท ััะฐะปะพะฝะฝะพะณะพ ัะฐะนะปะฐ**
**API:** `/api/objects/analyze-excel`

#### **ะคัะฝะบัะธะธ:**
- ๐ **ะงัะตะฝะธะต ััะฐะปะพะฝะฝะพะณะพ ัะฐะนะปะฐ** `data/objects.xlsx`
- ๐ **ะะฟัะตะดะตะปะตะฝะธะต ััััะบัััั** ะบะพะปะพะฝะพะบ ะธ ะธั ะฝะฐะทะฝะฐัะตะฝะธั
- ๐ **ะกะพะฟะพััะฐะฒะปะตะฝะธะต ะฟะพะปะตะน** ั ะฟะพะปัะผะธ ะะ
- ๐ **ะกะพะทะดะฐะฝะธะต ััะตะผั ะธะผะฟะพััะฐ** ะฝะฐ ะพัะฝะพะฒะต ััะฐะปะพะฝะฐ

#### **ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะฟะพััะฐะฒะปะตะฝะธะต:**
```typescript
const fieldMapping = {
  name: ['ะฝะฐะทะฒะฐะฝะธะต', 'ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต', 'name', 'ะพะฑัะตะบั'],
  address: ['ะฐะดัะตั', 'address', 'ะผะตััะพะฟะพะปะพะถะตะฝะธะต'],
  description: ['ะพะฟะธัะฐะฝะธะต', 'description', 'ะฟัะธะผะตัะฐะฝะธะต'],
  area: ['ะฟะปะพัะฐะดั', 'area', 'ัะฐะทะผะตั'],
  managerName: ['ะผะตะฝะตะดะถะตั', 'manager', 'ะพัะฒะตัััะฒะตะฝะฝัะน'],
  managerPhone: ['ัะตะปะตัะพะฝ ะผะตะฝะตะดะถะตัะฐ', 'phone', 'ะบะพะฝัะฐะบั'],
  managerEmail: ['email ะผะตะฝะตะดะถะตัะฐ', 'email', 'ะฟะพััะฐ'],
  workingHours: ['ัะฐะฑะพัะธะต ัะฐัั', 'ะฒัะตะผั ัะฐะฑะพัั', 'ะณัะฐัะธะบ'],
  workingDays: ['ัะฐะฑะพัะธะต ะดะฝะธ', 'ะดะฝะธ ัะฐะฑะพัั'],
  // ... ะธ ะดััะณะธะต ะฟะพะปั
};
```

### **2. ะะฐััะธัะตะฝะฝัะน ะธะผะฟะพัั ะพะฑัะตะบัะพะฒ**
**API:** `/api/objects/advanced-upload`

#### **ะะปััะตะฒัะต ะฒะพะทะผะพะถะฝะพััะธ:**
- ๐ **ะฃะผะฝัะน ะฟะพะธัะบ ะผะตะฝะตะดะถะตัะพะฒ** ะฟะพ ะธะผะตะฝะธ ะฒ ะะ
- ๐๏ธ **ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต ััััะบัััั** ะพะฑัะตะบัะฐ
- ๐ **ะัะธะฒัะทะบะฐ ัะตัะบะฐัั** ะบ ะฟะพะผะตัะตะฝะธัะผ
- ๐ **ะะตัะฐะปัะฝะฐั ะพััะตัะฝะพััั** ะพ ะฟัะพัะตััะต ะธะผะฟะพััะฐ

#### **ะะพะธัะบ ะผะตะฝะตะดะถะตัะพะฒ:**
```typescript
async function findManagerByName(name: string) {
  // 1. ะขะพัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต ะฟะพ ะธะผะตะฝะธ
  let manager = await prisma.user.findFirst({
    where: { name: { equals: searchName, mode: 'insensitive' }, role: 'MANAGER' }
  });
  
  // 2. ะงะฐััะธัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต, ะตัะปะธ ัะพัะฝะพะต ะฝะต ะฝะฐะนะดะตะฝะพ
  if (!manager) {
    manager = await prisma.user.findFirst({
      where: { name: { contains: searchName, mode: 'insensitive' }, role: 'MANAGER' }
    });
  }
  
  return manager;
}
```

#### **ะกะพะทะดะฐะฝะธะต ััััะบัััั ะพะฑัะตะบัะฐ:**
```typescript
async function createObjectStructure(objectId: string, objectName: string) {
  // 1. ะกะพะทะดะฐะตะผ ััะฐััะพะบ
  const site = await prisma.site.create({
    data: { name: `ะฃัะฐััะพะบ 1 - ${objectName}`, objectId }
  });
  
  // 2. ะกะพะทะดะฐะตะผ ะทะพะฝั
  const zone = await prisma.zone.create({
    data: { name: `ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ - ${objectName}`, siteId: site.id }
  });
  
  // 3. ะกะพะทะดะฐะตะผ ะณััะฟะฟั ะฟะพะผะตัะตะฝะธะน
  const roomGroup = await prisma.roomGroup.create({
    data: { name: `ะะพะผะตัะตะฝะธั - ${objectName}`, zoneId: zone.id }
  });
  
  // 4. ะกะพะทะดะฐะตะผ ะฟะพะผะตัะตะฝะธะต
  const room = await prisma.room.create({
    data: { name: `ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต`, objectId, roomGroupId: roomGroup.id }
  });
  
  // 5. ะัะธะฒัะทัะฒะฐะตะผ ัะตัะบะฐััั
  const techCards = await prisma.techCard.findMany({
    where: { OR: [
      { name: { contains: 'ะฃะฑะพัะบะฐ', mode: 'insensitive' } },
      { name: { contains: 'ะัััะต', mode: 'insensitive' } },
      { name: { contains: 'ะัะพัะธัะบะฐ', mode: 'insensitive' } }
    ]}, take: 3
  });
  
  // ะัะธะฒัะทัะฒะฐะตะผ ัะตัะบะฐััั ะบ ะฟะพะผะตัะตะฝะธั
  for (const techCard of techCards) {
    await prisma.room.update({
      where: { id: room.id },
      data: { techCards: { connect: { id: techCard.id } } }
    });
  }
}
```

### **3. ะฃะปัััะตะฝะฝัะน ัะฐะฑะปะพะฝ Excel**
**API:** `/api/objects/export-excel?type=template`

#### **ะคัะฝะบัะธะธ:**
- ๐ **ะัะฟะพะปัะทัะตั ััััะบัััั ััะฐะปะพะฝะฝะพะณะพ ัะฐะนะปะฐ**
- ๐ **ะกะพะทะดะฐะตั ะฟัะธะผะตัั ะดะปั ะฒัะตั ะบะพะปะพะฝะพะบ**
- ๐ **ะะฒัะพะผะฐัะธัะตัะบะฐั ัะธัะธะฝะฐ ะบะพะปะพะฝะพะบ**
- ๐ก **ะะฝัะพัะผะฐัะธะฒะฝัะต ะฟัะธะผะตัั ะดะฐะฝะฝัั**

#### **ะะตะฝะตัะฐัะธั ะฟัะธะผะตัะพะฒ:**
```typescript
templateStructure.headers.forEach((header: string) => {
  if (header.toLowerCase().includes('ะฝะฐะทะฒะฐะฝะธะต')) {
    example1[header] = 'ะัะธะผะตั: ะขะพัะณะพะฒัะน ัะตะฝัั "ะะฐะปะตัะตั"';
  } else if (header.toLowerCase().includes('ะผะตะฝะตะดะถะตั')) {
    example1[header] = 'ะะฒะฐะฝะพะฒ ะะตัั ะกะตัะณะตะตะฒะธั';
  } else if (header.toLowerCase().includes('ัะตะปะตัะพะฝ')) {
    example1[header] = '+7 (999) 123-45-67';
  }
  // ... ะดะปั ะฒัะตั ัะธะฟะพะฒ ะฟะพะปะตะน
});
```

### **4. ะะฑะฝะพะฒะปะตะฝะฝัะน ะธะฝัะตััะตะนั**
**ะะพะผะฟะพะฝะตะฝั:** `SimpleExcelUpload.tsx`

#### **ะะพะฒัะต ะฒะพะทะผะพะถะฝะพััะธ:**
- ๐ **ะะฐััะธัะตะฝะฝะฐั ััะฐัะธััะธะบะฐ** - ะพะฑัะตะบัั, ััััะบัััั, ะผะตะฝะตะดะถะตัั
- ๐ **ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั** ะพ ะบะฐะถะดะพะผ ัะพะทะดะฐะฝะฝะพะผ ะพะฑัะตะบัะต
- โ **ะกัะฐััั ะฟะพะธัะบะฐ ะผะตะฝะตะดะถะตัะพะฒ** - ะฝะฐะนะดะตะฝ/ะฝะต ะฝะฐะนะดะตะฝ
- ๐๏ธ **ะะฝัะพัะผะฐัะธั ะพ ััััะบัััะต** - ััะฐััะบะธ, ะทะพะฝั, ะฟะพะผะตัะตะฝะธั, ัะตัะบะฐััั

## ๐ฏ ะะะะะะ ะะะะะขะซ

### **ะะฑัะทะฐัะตะปัะฝัะต ะฟะพะปั:**
- โ **ะขะพะปัะบะพ "ะะฐะทะฒะฐะฝะธะต"** - ะตะดะธะฝััะฒะตะฝะฝะพะต ะพะฑัะทะฐัะตะปัะฝะพะต ะฟะพะปะต
- โ๏ธ **ะัะต ะพััะฐะปัะฝัะต** - ะพะฟัะธะพะฝะฐะปัะฝัะต, ะทะฐะฟะพะปะฝััััั ะตัะปะธ ะตััั

### **ะะฒัะพะผะฐัะธัะตัะบะพะต ะทะฐะฟะพะปะฝะตะฝะธะต:**
- ๐ **ะะดัะตั**: ะตัะปะธ ะฝะต ัะบะฐะทะฐะฝ โ "ะะต ัะบะฐะทะฐะฝ"
- ๐ค **ะะตะฝะตะดะถะตั**: ะฟะพะธัะบ ะฒ ะะ โ ะตัะปะธ ะฝะฐะนะดะตะฝ, ะฟัะธะฒัะทัะฒะฐะตััั
- ๐๏ธ **ะกัััะบัััะฐ**: ะฒัะตะณะดะฐ ัะพะทะดะฐะตััั ะฑะฐะทะพะฒะฐั ััััะบัััะฐ
- ๐ **ะขะตัะบะฐััั**: ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธะฒัะทัะฒะฐัััั ะฑะฐะทะพะฒัะต

### **ะะพะธัะบ ะผะตะฝะตะดะถะตัะพะฒ:**
1. **ะขะพัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต** ะฟะพ ะธะผะตะฝะธ
2. **ะงะฐััะธัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต** ะตัะปะธ ัะพัะฝะพะต ะฝะต ะฝะฐะนะดะตะฝะพ
3. **ะะต ะฝะฐะนะดะตะฝ** โ ะพะฑัะตะบั ัะพะทะดะฐะตััั ะฑะตะท ะผะตะฝะตะดะถะตัะฐ

## ๐ ะะะะะะ ะะะะฃะะฌะขะะขะ ะะะะะะขะ

### **ะกัะฐัะธััะธะบะฐ:**
```
โ 5 ะพะฑัะตะบัะพะฒ ัะพะทะดะฐะฝะพ
๐๏ธ 5 ััััะบััั ัะพะทะดะฐะฝะพ  
๐ค 3 ะผะตะฝะตะดะถะตัะฐ ะฝะฐะนะดะตะฝะพ
โ 1 ะพัะธะฑะบะฐ
```

### **ะะตัะฐะปะธ ัะพะทะดะฐะฝะฝะพะณะพ ะพะฑัะตะบัะฐ:**
```
๐ข ะขะฆ "ะกะตะผะตะนะฝัะน"
โโโ ๐ค ะะตะฝะตะดะถะตั: โ ะะฒะฐะฝะพะฒ ะะตัั ะกะตัะณะตะตะฒะธั
โโโ ๐๏ธ ะกะพะทะดะฐะฝะฐ ััััะบัััะฐ:
    โโโ ๐ ะฃัะฐััะพะบ 1 - ะขะฆ "ะกะตะผะตะนะฝัะน"
    โโโ ๐ข ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ - ะขะฆ "ะกะตะผะตะนะฝัะน"
    โโโ ๐ ะะพะผะตัะตะฝะธั - ะขะฆ "ะกะตะผะตะนะฝัะน"
    โโโ ๐ช ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต
    โโโ ๐ ะขะตัะบะฐัั: 3
```

### **ะัะปะธ ะผะตะฝะตะดะถะตั ะฝะต ะฝะฐะนะดะตะฝ:**
```
๐ข ะะฆ "ะะพะฒัะน"
โโโ ๐ค ะะตะฝะตะดะถะตั: โ ะะตััะพะฒ ะ.ะ. (ะฝะต ะฝะฐะนะดะตะฝ)
โโโ ๐๏ธ ะกะพะทะดะฐะฝะฐ ััััะบัััะฐ: [ะฟะพะปะฝะฐั ััััะบัััะฐ]
```

## ๐ง ะขะะฅะะะงะะกะะะ ะะะขะะะ

### **ะะพะดะดะตัะถะธะฒะฐะตะผัะต ะบะพะปะพะฝะบะธ Excel:**
- **ะะฐะทะฒะฐะฝะธะต** (ะพะฑัะทะฐัะตะปัะฝะพ)
- **ะะดัะตั** 
- **ะะฟะธัะฐะฝะธะต**
- **ะะปะพัะฐะดั**
- **ะะตะฝะตะดะถะตั**
- **ะขะตะปะตัะพะฝ ะผะตะฝะตะดะถะตัะฐ**
- **Email ะผะตะฝะตะดะถะตัะฐ**
- **ะะฐะฑะพัะธะต ัะฐัั**
- **ะะฐะฑะพัะธะต ะดะฝะธ**
- **ะัะธะผะตัะฐะฝะธั**
- **ะงะฐัะพะฒะพะน ะฟะพัั**
- **ะัะฑัะต ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะพะปั**

### **ะะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะฒะฐะตะผะฐั ััััะบัััะฐ:**
```
๐ข ะะฑัะตะบั
โโโ ๐ ะฃัะฐััะพะบ 1
โ   โโโ ๐ข ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ
โ       โโโ ๐ ะััะฟะฟะฐ ะฟะพะผะตัะตะฝะธะน
โ           โโโ ๐ช ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต
โ               โโโ ๐ ะขะตัะบะฐััั (3 ัั.)
โโโ ๐ค ะะตะฝะตะดะถะตั (ะตัะปะธ ะฝะฐะนะดะตะฝ)
```

### **ะัะธะฒัะทัะฒะฐะตะผัะต ัะตัะบะฐััั:**
- ๐งน ะขะตัะบะฐััั ั "ะฃะฑะพัะบะฐ" ะฒ ะฝะฐะทะฒะฐะฝะธะธ
- ๐ง ะขะตัะบะฐััั ั "ะัััะต" ะฒ ะฝะฐะทะฒะฐะฝะธะธ  
- ๐งฝ ะขะตัะบะฐััั ั "ะัะพัะธัะบะฐ" ะฒ ะฝะฐะทะฒะฐะฝะธะธ
- ๐ ะะฐะบัะธะผัะผ 3 ัะตัะบะฐััั ะฝะฐ ะพะฑัะตะบั

## ๐ ะะะขะะะซะ ะคะฃะะะฆะะะะะ

### **ะงัะพ ัะฐะฑะพัะฐะตั:**
- โ **ะะฝะฐะปะธะท ััะฐะปะพะฝะฝะพะณะพ ัะฐะนะปะฐ** ะธ ัะพะทะดะฐะฝะธะต ััะตะผั
- โ **ะฃะผะฝัะน ะฟะพะธัะบ ะผะตะฝะตะดะถะตัะพะฒ** ะฟะพ ะธะผะตะฝะธ
- โ **ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต** ะฟะพะปะฝะพะน ััััะบัััั ะพะฑัะตะบัะฐ
- โ **ะัะธะฒัะทะบะฐ ัะตัะบะฐัั** ะบ ะฟะพะผะตัะตะฝะธัะผ
- โ **ะะตัะฐะปัะฝะฐั ะพััะตัะฝะพััั** ะพ ะฟัะพัะตััะต ะธะผะฟะพััะฐ
- โ **ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ** ั ะฟะพะฝััะฝัะผะธ ัะพะพะฑัะตะฝะธัะผะธ
- โ **ะะฝัะพัะผะฐัะธะฒะฝัะน ัะฐะฑะปะพะฝ** ะฝะฐ ะพัะฝะพะฒะต ััะฐะปะพะฝะฐ

### **ะะตะทัะปััะฐั ะธะผะฟะพััะฐ:**
- ๐ข **ะะฑัะตะบั ัะพะทะดะฐะฝ** ั ะฟะพะปะฝัะผะธ ะดะฐะฝะฝัะผะธ
- ๐ค **ะะตะฝะตะดะถะตั ะฝะฐะนะดะตะฝ ะธ ะฟัะธะฒัะทะฐะฝ** (ะตัะปะธ ะตััั ะฒ ะะ)
- ๐๏ธ **ะกัััะบัััะฐ ัะพะทะดะฐะฝะฐ**: ััะฐััะพะบ โ ะทะพะฝะฐ โ ะณััะฟะฟะฐ โ ะฟะพะผะตัะตะฝะธะต
- ๐ **ะขะตัะบะฐััั ะฟัะธะฒัะทะฐะฝั** ะบ ะฟะพะผะตัะตะฝะธั
- โก **ะะฐะดะฐัะธ ะฑัะดัั ะณะตะฝะตัะธัะพะฒะฐัััั** ะฐะฒัะพะผะฐัะธัะตัะบะธ

### **ะะพัััะฟ:**
- ๐ **URL**: http://localhost:3001/objects
- ๐ฅ **ะะพะปัะทะพะฒะฐัะตะปะธ**: ะะดะผะธะฝั ะธ ะทะฐะผะตััะธัะตะปะธ
- ๐ฑ **ะะฝัะตััะตะนั**: ะัะพััะพะน ะธ ะธะฝัะพัะผะฐัะธะฒะฝัะน

---

**ะะะกะจะะะะะะซะ ะะะะะะข EXCEL ะะะขะะ!** ๐

ะขะตะฟะตัั ะฟัะธ ะทะฐะณััะทะบะต Excel ัะฐะนะปะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ:
1. **ะกะพะทะดะฐะตััั ะพะฑัะตะบั** ั ะฟะพะปะฝัะผะธ ะดะฐะฝะฝัะผะธ ะธะท ัะฐะนะปะฐ
2. **ะัะตััั ะธ ะฟัะธะฒัะทัะฒะฐะตััั ะผะตะฝะตะดะถะตั** ะธะท ะะ
3. **ะกะพะทะดะฐะตััั ะฟะพะปะฝะฐั ััััะบัััะฐ** - ััะฐััะบะธ, ะทะพะฝั, ะฟะพะผะตัะตะฝะธั
4. **ะัะธะฒัะทัะฒะฐัััั ัะตัะบะฐััั** ะดะปั ะณะตะฝะตัะฐัะธะธ ะทะฐะดะฐั
5. **ะัะตะดะพััะฐะฒะปัะตััั ะดะตัะฐะปัะฝัะน ะพััะตั** ะพ ะฟัะพัะตััะต

ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ะฟะพะปะฝะพัะตะฝะฝะพะน ัะฐะฑะพัะต ั ะพะฑัะตะบัะฐะผะธ!
