# –ü–õ–ê–ù –ë–ï–ó–û–ü–ê–°–ù–û–ô –û–ß–ò–°–¢–ö–ò –°–¢–ê–†–´–• –ó–ê–î–ê–ß

## üéØ –¶–ï–õ–¨
–ê–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –≤—Å–µ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ —Å–ª–æ–º–∞–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï
- **3,754 —Ç–µ—Ö–∫–∞—Ä—Ç—ã** (–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã) ‚úÖ
- **3,754 –∑–∞–¥–∞—á–∏** –Ω–∞ 23.10.2025 (—Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- **1 –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è** –∑–∞–¥–∞—á–∞ (—Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏)
- **0 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** –∞–¥–º–∏–Ω–æ–≤
- **20 –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤** –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –Ω–∞ –æ–±—ä–µ–∫—Ç—ã

## üîÑ –ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ì–û–¢–û–í–ê
‚úÖ **API –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á**: `/api/tasks/virtual`, `/api/tasks/calendar-virtual`
‚úÖ **–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: `/api/tasks/materialize`
‚úÖ **–û–±—â–∏–µ —Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç—ã**: `/api/photo-reports/general`
‚úÖ **–£—Ç–∏–ª–∏—Ç—ã**: `src/lib/virtual-tasks.ts`

## üõ°Ô∏è –ü–õ–ê–ù –ë–ï–ó–û–ü–ê–°–ù–û–ô –ú–ò–ì–†–ê–¶–ò–ò

### –≠–¢–ê–ü 1: –°–û–•–†–ê–ù–ï–ù–ò–ï –í–ê–ñ–ù–´–• –î–ê–ù–ù–´–• (–ö–†–ò–¢–ò–ß–ù–û)
```sql
-- –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –∏—Ö –¥–∞–Ω–Ω—ã–µ
SELECT * FROM Task WHERE status = 'COMPLETED';
-- –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–æ–≤
SELECT * FROM TaskAdminComment;
-- –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç—ã
SELECT * FROM PhotoReport WHERE taskId IS NOT NULL;
```

### –≠–¢–ê–ü 2: –°–û–ó–î–ê–ù–ò–ï –†–ï–ó–ï–†–í–ù–û–ô –ö–û–ü–ò–ò
1. **–≠–∫—Å–ø–æ—Ä—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á** –≤ JSON
2. **–≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** –≤ JSON  
3. **–≠–∫—Å–ø–æ—Ä—Ç —Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç–æ–≤** –≤ JSON
4. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è**

### –≠–¢–ê–ü 3: –ü–û–°–¢–ï–ü–ï–ù–ù–ê–Ø –û–ß–ò–°–¢–ö–ê
1. **–£–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ NEW/AVAILABLE –∑–∞–¥–∞—á–∏** (–Ω–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∏)
2. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å COMPLETED –∑–∞–¥–∞—á–∏** (–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏)
3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏** (–µ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á–∏ —Å —Ñ–æ—Ç–æ** (–µ—Å—Ç—å –æ—Ç—á–µ—Ç—ã)

### –≠–¢–ê–ü 4: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏** —Ä–∞–±–æ—Ç–∞—é—Ç
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é** —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìã –°–ö–†–ò–ü–¢–´ –ë–ï–ó–û–ü–ê–°–ù–û–ô –û–ß–ò–°–¢–ö–ò

### 1Ô∏è‚É£ –°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```javascript
// analyze-tasks-for-cleanup.js
const { PrismaClient } = require('@prisma/client');
const fs = require('fs');

const prisma = new PrismaClient();

async function analyzeTasksForCleanup() {
  // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
  const tasksToKeep = await prisma.task.findMany({
    where: {
      OR: [
        { status: 'COMPLETED' },
        { status: 'IN_PROGRESS' },
        { completionComment: { not: null } },
        { completionPhotos: { not: { equals: [] } } },
        { completedAt: { not: null } }
      ]
    },
    include: {
      _count: {
        select: {
          adminComments: true,
          photoReports: true
        }
      }
    }
  });

  const tasksToDelete = await prisma.task.findMany({
    where: {
      AND: [
        { status: { in: ['NEW', 'AVAILABLE'] } },
        { completionComment: null },
        { completedAt: null },
        { completionPhotos: { equals: [] } }
      ]
    }
  });

  console.log('üìä –ê–ù–ê–õ–ò–ó –ó–ê–î–ê–ß:');
  console.log(`‚úÖ –ó–∞–¥–∞—á –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é: ${tasksToKeep.length}`);
  console.log(`üóëÔ∏è –ó–∞–¥–∞—á –∫ —É–¥–∞–ª–µ–Ω–∏—é: ${tasksToDelete.length}`);
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–∞–Ω –≤ —Ñ–∞–π–ª
  fs.writeFileSync('cleanup-plan.json', JSON.stringify({
    tasksToKeep: tasksToKeep.map(t => t.id),
    tasksToDelete: tasksToDelete.map(t => t.id),
    analysis: {
      totalTasks: tasksToKeep.length + tasksToDelete.length,
      keepCount: tasksToKeep.length,
      deleteCount: tasksToDelete.length,
      savingPercentage: Math.round((tasksToDelete.length / (tasksToKeep.length + tasksToDelete.length)) * 100)
    }
  }, null, 2));
}
```

### 2Ô∏è‚É£ –°–∫—Ä–∏–ø—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
```javascript
// backup-important-data.js
async function backupImportantData() {
  // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
  const completedTasks = await prisma.task.findMany({
    where: { status: 'COMPLETED' },
    include: {
      adminComments: true,
      photoReports: true
    }
  });

  // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–æ–≤
  const adminComments = await prisma.taskAdminComment.findMany({
    include: {
      task: { select: { id: true, description: true } },
      admin: { select: { name: true, email: true } }
    }
  });

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª—ã
  fs.writeFileSync('backup-completed-tasks.json', JSON.stringify(completedTasks, null, 2));
  fs.writeFileSync('backup-admin-comments.json', JSON.stringify(adminComments, null, 2));
}
```

### 3Ô∏è‚É£ –°–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
```javascript
// safe-cleanup-tasks.js
async function safeCleanupTasks() {
  const plan = JSON.parse(fs.readFileSync('cleanup-plan.json', 'utf8'));
  
  console.log(`üóëÔ∏è –£–¥–∞–ª—è–µ–º ${plan.tasksToDelete.length} –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–∞–¥–∞—á...`);
  
  // –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
  const result = await prisma.task.deleteMany({
    where: {
      id: { in: plan.tasksToDelete }
    }
  });
  
  console.log(`‚úÖ –£–¥–∞–ª–µ–Ω–æ –∑–∞–¥–∞—á: ${result.count}`);
  console.log(`üíæ –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞ –≤ –ë–î: ${Math.round(result.count / 1000)}k –∑–∞–ø–∏—Å–µ–π`);
}
```

## ‚ö†Ô∏è –ü–†–ê–í–ò–õ–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### ‚ùå –ù–ï –£–î–ê–õ–Ø–¢–¨:
- –ó–∞–¥–∞—á–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `COMPLETED`
- –ó–∞–¥–∞—á–∏ —Å `completionComment`
- –ó–∞–¥–∞—á–∏ —Å `completionPhotos`
- –ó–∞–¥–∞—á–∏ —Å `completedAt`
- –ó–∞–¥–∞—á–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∞–¥–º–∏–Ω–æ–≤
- –ó–∞–¥–∞—á–∏ —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç–∞–º–∏

### ‚úÖ –ú–û–ñ–ù–û –£–î–ê–õ–ò–¢–¨:
- –ó–∞–¥–∞—á–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `NEW` –∏–ª–∏ `AVAILABLE`
- –ó–∞–¥–∞—á–∏ –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ó–∞–¥–∞—á–∏ –±–µ–∑ —Ñ–æ—Ç–æ
- –ó–∞–¥–∞—á–∏ –±–µ–∑ –¥–∞—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –ó–∞–¥–∞—á–∏ –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–û –û–ß–ò–°–¢–ö–ò:
- 3,754 –∑–∞–¥–∞—á–∏ –≤ –ë–î
- –ë–æ–ª—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ—Ö–∫–∞—Ä—Ç

### –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò:
- ~10-50 –∑–∞–¥–∞—á –≤ –ë–î (—Ç–æ–ª—å–∫–æ —Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º)
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ç–µ—Ö–∫–∞—Ä—Ç
- –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –≠–∫–æ–Ω–æ–º–∏—è 95%+ –º–µ—Å—Ç–∞ –≤ –ë–î

## üìã –ß–ï–ö–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

- [ ] 1. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (`analyze-tasks-for-cleanup.js`)
- [ ] 2. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ (`backup-important-data.js`)
- [ ] 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
- [ ] 4. –í—ã–ø–æ–ª–Ω–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—É—é –æ—á–∏—Å—Ç–∫—É (`safe-cleanup-tasks.js`)
- [ ] 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã
- [ ] 6. –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –Ω–æ–≤—ã–µ API
- [ ] 7. –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É –æ–±—â–∏—Ö —Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç–æ–≤

## üöÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

**–¢–µ—Ö–∫–∞—Ä—Ç—ã (3,754)** ‚Üí **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏** ‚Üí **–†–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)**

- –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –≤–∏–¥—è—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ –∫–∞–∫ –æ–±—ã—á–Ω–æ
- –ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç –∑–∞–¥–∞—á–∏
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞–µ—Ç—Å—è —á–∏—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π

**–ì–û–¢–û–í–û –ö –ë–ï–ó–û–ü–ê–°–ù–û–ú–£ –í–ù–ï–î–†–ï–ù–ò–Æ!**
