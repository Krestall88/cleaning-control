# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Telegram –ø—Ä–∏–≤—è–∑–∫–∏

## ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞–π–¥–µ–Ω—ã:

1. **`TELEGRAM_BOT_USERNAME` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`**
2. **`TELEGRAM_WEBHOOK_URL` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**
3. **Webhook —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ Vercel –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞**
4. **–°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–∏–≤—è–∑–∫–∏ –∏—Å—Ç–µ–∫**

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ:

### 1. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env` —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ:

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
TELEGRAM_BOT_USERNAME=cleaning_control_test_bot
TELEGRAM_WEBHOOK_URL=http://localhost:3000/api/webhooks/telegram

# –ò–ª–∏ –¥–ª—è production (Vercel):
# TELEGRAM_WEBHOOK_URL=https://cleaning-control.vercel.app/api/webhooks/telegram
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# –°–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/download

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok
ngrok http 3000

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://abc123.ngrok.io)
# –û–±–Ω–æ–≤–∏—Ç–µ .env:
TELEGRAM_WEBHOOK_URL=https://abc123.ngrok.io/api/webhooks/telegram

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook
curl -X POST "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/setWebhook" \
  -d "url=https://abc123.ngrok.io/api/webhooks/telegram"
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Vercel (–¥–ª—è production)

Webhook —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ Vercel. –ü—Ä–æ—Å—Ç–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ Vercel Dashboard.

#### –í–∞—Ä–∏–∞–Ω—Ç –í: –û—Ç–∫–ª—é—á–∏—Ç–µ webhook –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –£–¥–∞–ª–∏—Ç–µ webhook
curl -X POST "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/deleteWebhook"

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ polling –≤–º–µ—Å—Ç–æ webhook (–¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–¥)
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
npm run dev
```

### 4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥ –ø—Ä–∏–≤—è–∑–∫–∏

1. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É: http://localhost:3000/auth/login
   - Email: `admin@example.com`
   - –ü–∞—Ä–æ–ª—å: `password123`

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
3. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–∏–≤—è–∑–∞—Ç—å Telegram"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥

### 5. –ü—Ä–∏–≤—è–∂–∏—Ç–µ Telegram

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É:
```
/bind –í–ê–®_–ö–û–î
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
npx tsx scripts/check-telegram.ts
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- ‚úÖ TELEGRAM_BOT_TOKEN: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ TELEGRAM_BOT_USERNAME: cleaning_control_test_bot
- ‚úÖ TELEGRAM_WEBHOOK_URL: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ Webhook URL: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ webhook

## üìù –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ngrok)

### –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok**
   ```bash
   # Windows (—á–µ—Ä–µ–∑ Chocolatey)
   choco install ngrok
   
   # –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/download
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok**
   ```bash
   ngrok http 3000
   ```

3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL**
   ```
   Forwarding https://abc123.ngrok.io -> http://localhost:3000
   ```

4. **–û–±–Ω–æ–≤–∏—Ç–µ .env**
   ```env
   TELEGRAM_WEBHOOK_URL=https://abc123.ngrok.io/api/webhooks/telegram
   ```

5. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook**
   ```bash
   curl -X POST "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/setWebhook" \
     -d "url=https://abc123.ngrok.io/api/webhooks/telegram"
   ```

6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook**
   ```bash
   curl "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/getWebhookInfo"
   ```

7. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**
   ```bash
   npm run dev
   ```

8. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤—è–∑–∫—É**
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
   - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ–¥ –ø—Ä–∏–≤—è–∑–∫–∏
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/bind –ö–û–î` –±–æ—Ç—É

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

- **ngrok URL –º–µ–Ω—è–µ—Ç—Å—è** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ ngrok –Ω—É–∂–Ω–æ **–æ–±–Ω–æ–≤–∏—Ç—å webhook**
- –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π URL** (Vercel, VPS –∏ —Ç.–¥.)

## üêõ –û—Ç–ª–∞–¥–∫–∞:

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook:
   ```bash
   curl "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/getWebhookInfo"
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥)

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ ngrok –∑–∞–ø—É—â–µ–Ω –∏ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### –ü—Ä–æ–±–ª–µ–º–∞: "–ö–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–¥ –Ω–µ –∏—Å—Ç–µ–∫ (15 –º–∏–Ω—É—Ç)
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–≤–æ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã)

### –ü—Ä–æ–±–ª–µ–º–∞: "Telegram —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω"

1. –û—Ç–≤—è–∂–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π Telegram –∞–∫–∫–∞—É–Ω—Ç

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```bash
npx tsx scripts/check-users.ts
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª–∏
```bash
npx tsx scripts/check-password.ts
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram
```bash
npx tsx scripts/check-telegram.ts
```

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç:

- [ ] `TELEGRAM_BOT_TOKEN` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
- [ ] `TELEGRAM_BOT_USERNAME` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
- [ ] `TELEGRAM_WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
- [ ] ngrok –∑–∞–ø—É—â–µ–Ω (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- [ ] Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –ö–æ–¥ –ø—Ä–∏–≤—è–∑–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- [ ] Telegram —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ Telegram –ø—Ä–∏–≤—è–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å!** üéâ
