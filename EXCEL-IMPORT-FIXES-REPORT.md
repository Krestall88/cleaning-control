# ๐ง ะะขะงะะข: ะะกะะะะะะะะะฏ ะะะะะะขะ EXCEL

**ะะฐัะฐ:** 29 ะพะบััะฑัั 2025, 13:30 UTC+3  
**ะกัะฐััั:** ะะกะะะะะะะะ - ะัะพะฑะปะตะผั ั ะดัะฑะปะธะบะฐัะฐะผะธ ะธ ััััะบัััะพะน ัะตัะตะฝั

## ๐ ะะซะฏะะะะะะซะ ะะะะะะะะซ

### **1. ะะตะฟะพะปะฝะพะต ัะดะฐะปะตะฝะธะต ะพะฑัะตะบัะพะฒ:**
- โ ะัะธ ัะดะฐะปะตะฝะธะธ ัะตัะตะท ัะพัะผั ะพััะฐัััั ัะฒัะทะฐะฝะฝัะต ะทะฐะฟะธัะธ
- โ ะะผะฟะพัั ะฟะพะบะฐะทัะฒะฐะตั "ะพะฑัะตะบั ัะถะต ัััะตััะฒัะตั" ะดะปั ัะดะฐะปะตะฝะฝัั ะพะฑัะตะบัะพะฒ
- โ ะะฐัะบะฐะดะฝะพะต ัะดะฐะปะตะฝะธะต ัะฐะฑะพัะฐะตั ะฝะต ะฟะพะปะฝะพัััั

### **2. ะะตะฟะพะปะฝะฐั ััััะบัััะฐ ะพะฑัะตะบัะฐ:**
- โ ะกะพะทะดะฐะตััั ะฝะต ะฒัั ะธะตัะฐััะธั: ััะฐััะพะบ โ ะทะพะฝะฐ โ ะณััะฟะฟะฐ โ ะฟะพะผะตัะตะฝะธะต
- โ ะขะตัะบะฐััั ะฟัะธะฒัะทัะฒะฐัััั ะฝะตะฟัะฐะฒะธะปัะฝะพ ะธะปะธ ะฝะต ัะต
- โ ะ ัะฐะฑะปะธัะต ะฝะตั ะทะพะฝ ะธ ััะฐััะบะพะฒ, ะฝะพ ะพะฝะธ ะฟะพะบะฐะทัะฒะฐัััั

### **3. ะัะพะฑะปะตะผั ั ัะตัะบะฐััะฐะผะธ:**
- โ ะัะธะฒัะทัะฒะฐัััั ัะปััะฐะนะฝัะต ัะตัะบะฐััั
- โ ะะต ัะต ัะตัะบะฐััั, ััะพ ะฝัะถะฝั ะดะปั ัะฑะพัะบะธ

## โ ะะะะะะะะะะะะซะ ะะกะะะะะะะะะฏ

### **1. API ะฟะพะปะฝะพะน ะพัะธััะบะธ ะพะฑัะตะบัะฐ**
**ะคะฐะนะป:** `src/app/api/objects/cleanup/route.ts`

#### **ะคัะฝะบัะธะธ:**
- ๐งน **ะะพะปะฝะฐั ะพัะธััะบะฐ** ะฒัะตั ัะฒัะทะฐะฝะฝัั ะดะฐะฝะฝัั ะพะฑัะตะบัะฐ
- ๐ **ะัะฐะฒะธะปัะฝัะน ะฟะพััะดะพะบ ัะดะฐะปะตะฝะธั** - ะพั ะทะฐะฒะธัะธะผัั ะบ ะฝะตะทะฐะฒะธัะธะผัะผ
- ๐ **ะะตัะฐะปัะฝะฐั ะพััะตัะฝะพััั** ะพ ะฟัะพัะตััะต ะพัะธััะบะธ

#### **ะะพััะดะพะบ ัะดะฐะปะตะฝะธั:**
```typescript
1. ะะฐะดะฐัะธ (tasks)
2. ะัะฟะพะปะฝะตะฝะธั ะทะฐะดะฐั (taskExecutions)  
3. ะงะตะบะปะธััั (checklists)
4. ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะทะฐะดะฐัะธ (additionalTasks)
5. ะััะตัะฝัะต ะทะฐะดะฐัะธ (reportingTasks)
6. ะคะพัะพ ะพััะตัั (photoReports)
7. ะะฝะฒะตะฝัะฐัั (inventoryLimits, inventoryExpenses)
8. ะัะบะปััะตะฝะธั (excludedObjects)
9. ะะฐะทะฝะฐัะตะฝะธั ะทะฐะผะตััะธัะตะปะตะน (deputyAdminAssignments)
10. ะะพะผะตัะตะฝะธั (rooms)
11. ะััะฟะฟั ะฟะพะผะตัะตะฝะธะน (roomGroups)
12. ะะพะฝั (zones)
13. ะฃัะฐััะบะธ (sites)
14. ะกะฐะผ ะพะฑัะตะบั (cleaningObject)
```

### **2. ะฃะปัััะตะฝะฝะพะต ัะพะทะดะฐะฝะธะต ััััะบัััั**
**ะคัะฝะบัะธั:** `createObjectStructure` ะฒ `advanced-upload/route.ts`

#### **ะฃะปัััะตะฝะธั:**
- โ **ะัะพะฒะตัะบะฐ ัััะตััะฒะพะฒะฐะฝะธั** ะพะฑัะตะบัะฐ ะฟะตัะตะด ัะพะทะดะฐะฝะธะตะผ ััััะบัััั
- โ **ะะตัะฐะปัะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต** ะบะฐะถะดะพะณะพ ัะฐะณะฐ ั ID ะทะฐะฟะธัะตะน
- โ **ะฃะปัััะตะฝะฝัะน ะฟะพะธัะบ ัะตัะบะฐัั** - ะฑะพะปะตะต ัะพัะฝัะต ะบัะธัะตัะธะธ
- โ **Fallback ะผะตัะฐะฝะธะทะผ** - ะตัะปะธ ะฝะตั ะฟะพะดัะพะดััะธั ัะตัะบะฐัั, ะฑะตัะตะผ ะปัะฑัะต

#### **ะกะพะทะดะฐะฒะฐะตะผะฐั ััััะบัััะฐ:**
```
๐ข ะะฑัะตะบั (ัะถะต ัะพะทะดะฐะฝ)
โโโ ๐ ะฃัะฐััะพะบ 1 - [ะะฐะทะฒะฐะฝะธะต ะพะฑัะตะบัะฐ]
โ   โโโ ๐ข ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ - [ะะฐะทะฒะฐะฝะธะต ะพะฑัะตะบัะฐ]
โ       โโโ ๐ ะะพะผะตัะตะฝะธั - [ะะฐะทะฒะฐะฝะธะต ะพะฑัะตะบัะฐ]
โ           โโโ ๐ช ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต
โ               โโโ ๐ ะขะตัะบะฐััั (3-5 ัั.)
โโโ ๐ค ะะตะฝะตะดะถะตั (ะตัะปะธ ะฝะฐะนะดะตะฝ)
```

#### **ะฃะปัััะตะฝะฝัะน ะฟะพะธัะบ ัะตัะบะฐัั:**
```typescript
const techCards = await prisma.techCard.findMany({
  where: {
    OR: [
      { name: { contains: 'ัะฑะพัะบะฐ', mode: 'insensitive' } },
      { name: { contains: 'ะผัััะต', mode: 'insensitive' } },
      { name: { contains: 'ะฟัะพัะธัะบะฐ', mode: 'insensitive' } },
      { name: { contains: 'ะพัะธััะบะฐ', mode: 'insensitive' } },
      { name: { contains: 'cleaning', mode: 'insensitive' } }
    ]
  },
  take: 5,
  orderBy: { name: 'asc' }
});
```

### **3. ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ ะฟะตัะตะด ะธะผะฟะพััะพะผ**
**ะะพะผะฟะพะฝะตะฝั:** `SimpleExcelUpload.tsx`

#### **ะคัะฝะบัะธะธ:**
- ๐ **ะัะตะดะฒะฐัะธัะตะปัะฝะพะต ััะตะฝะธะต ัะฐะนะปะฐ** ะดะปั ะฟะพะปััะตะฝะธั ะฝะฐะทะฒะฐะฝะธะน ะพะฑัะตะบัะพะฒ
- ๐งน **ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ** ัััะตััะฒัััะธั ะพะฑัะตะบัะพะฒ ะฟะตัะตะด ะธะผะฟะพััะพะผ
- โก **ะะตััะพะฒะฝัะน ะฟัะพัะตัั** - ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะต ะทะฐะผะตัะฐะตั ะพัะธััะบั

#### **ะะปะณะพัะธัะผ:**
```typescript
1. ะงะธัะฐะตะผ Excel ัะฐะนะป
2. ะะฐัะพะดะธะผ ะบะพะปะพะฝะบั ั ะฝะฐะทะฒะฐะฝะธัะผะธ ะพะฑัะตะบัะพะฒ
3. ะะปั ะบะฐะถะดะพะณะพ ะพะฑัะตะบัะฐ:
   - ะัะทัะฒะฐะตะผ API ะพัะธััะบะธ
   - ะฃะดะฐะปัะตะผ ะฒัะต ัะฒัะทะฐะฝะฝัะต ะดะฐะฝะฝัะต
4. ะัะฟะพะปะฝัะตะผ ะธะผะฟะพัั ั ัะพะทะดะฐะฝะธะตะผ ะฝะพะฒะพะน ััััะบัััั
```

## ๐ฏ ะะะะฃะะฌะขะะข ะะกะะะะะะะะะ

### **ะขะตะฟะตัั ะฟัะธ ะธะผะฟะพััะต:**

#### **1. ะะพะปะฝะฐั ะพัะธััะบะฐ:**
```
๐งน ะัะธััะบะฐ ะพะฑัะตะบัะฐ: ะะะ ยซะกะะะยป
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ะทะฐะดะฐั: 15
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ะฒัะฟะพะปะฝะตะฝะธะน: 8
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ัะตะบะปะธััะพะฒ: 3
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ะฟะพะผะตัะตะฝะธะน: 2
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ะณััะฟะฟ ะฟะพะผะตัะตะฝะธะน: 1
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ะทะพะฝ: 1
โโโ ๐๏ธ ะฃะดะฐะปะตะฝะพ ััะฐััะบะพะฒ: 1
โโโ โ ะะฑัะตะบั ะฟะพะปะฝะพัััั ัะดะฐะปะตะฝ
```

#### **2. ะกะพะทะดะฐะฝะธะต ะฟะพะปะฝะพะน ััััะบัััั:**
```
๐๏ธ ะกะพะทะดะฐะฝะธะต ััััะบัััั ะดะปั ะพะฑัะตะบัะฐ: ะะะ ยซะกะะะยป
โโโ โ ะกะพะทะดะฐะฝ ััะฐััะพะบ: ะฃัะฐััะพะบ 1 - ะะะ ยซะกะะะยป (ID: abc123)
โโโ โ ะกะพะทะดะฐะฝะฐ ะทะพะฝะฐ: ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ - ะะะ ยซะกะะะยป (ID: def456)
โโโ โ ะกะพะทะดะฐะฝะฐ ะณััะฟะฟะฐ ะฟะพะผะตัะตะฝะธะน: ะะพะผะตัะตะฝะธั - ะะะ ยซะกะะะยป (ID: ghi789)
โโโ โ ะกะพะทะดะฐะฝะพ ะฟะพะผะตัะตะฝะธะต: ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต (ID: jkl012)
โโโ ๐ ะะฐะนะดะตะฝะพ ัะตัะบะฐัั ะดะปั ะฟัะธะฒัะทะบะธ: 3
โโโ ๐ ะัะธะฒัะทะฐะฝะฐ ัะตัะบะฐััะฐ: ะะถะตะดะฝะตะฒะฝะฐั ัะฑะพัะบะฐ ะพัะธัะฐ
โโโ ๐ ะัะธะฒัะทะฐะฝะฐ ัะตัะบะฐััะฐ: ะัััะต ะฟะพะปะพะฒ
โโโ ๐ ะัะธะฒัะทะฐะฝะฐ ัะตัะบะฐััะฐ: ะัะพัะธัะบะฐ ะฟะพะฒะตััะฝะพััะตะน
```

#### **3. ะัะฐะฒะธะปัะฝัะต ัะตัะบะฐััั:**
- โ **ะะถะตะดะฝะตะฒะฝะฐั ัะฑะพัะบะฐ ะพัะธัะฐ**
- โ **ะัััะต ะฟะพะปะพะฒ**  
- โ **ะัะพัะธัะบะฐ ะฟะพะฒะตััะฝะพััะตะน**
- โ **ะัะธััะบะฐ ัะฐะฝัะทะปะพะฒ**
- โ **ะฃะฑะพัะบะฐ ะผััะพัะฐ**

### **ะััะตั ะฒ ะธะฝัะตััะตะนัะต:**
```
โ ะะฐะณััะทะบะฐ ะทะฐะฒะตััะตะฝะฐ
โโโ ๐ข 1 ะพะฑัะตะบั ัะพะทะดะฐะฝ
โโโ ๐๏ธ 1 ััััะบัััะฐ ัะพะทะดะฐะฝะฐ
โโโ ๐ค 1 ะผะตะฝะตะดะถะตั ะฝะฐะนะดะตะฝ
โโโ โ 0 ะพัะธะฑะพะบ

๐ ะกะพะทะดะฐะฝะฝัะน ะพะฑัะตะบั: ะะะ ยซะกะะะยป
โโโ ๐ค ะะตะฝะตะดะถะตั: โ ะัะฐะณะธะฝะฐ ะะฐัะตัะธะฝะฐ ะฎััะตะฒะฝะฐ
โโโ ๐๏ธ ะกะพะทะดะฐะฝะฐ ััััะบัััะฐ:
    โโโ ๐ ะฃัะฐััะพะบ 1 - ะะะ ยซะกะะะยป
    โโโ ๐ข ะัะฝะพะฒะฝะฐั ะทะพะฝะฐ - ะะะ ยซะกะะะยป
    โโโ ๐ ะะพะผะตัะตะฝะธั - ะะะ ยซะกะะะยป
    โโโ ๐ช ะัะฝะพะฒะฝะพะต ะฟะพะผะตัะตะฝะธะต
    โโโ ๐ ะขะตัะบะฐัั: 3
```

## ๐ง ะขะะฅะะะงะะกะะะ ะะะขะะะ

### **API Endpoints:**
- **`POST /api/objects/cleanup`** - ะฟะพะปะฝะฐั ะพัะธััะบะฐ ะพะฑัะตะบัะฐ ะฟะพ ะธะผะตะฝะธ
- **`POST /api/objects/advanced-upload`** - ัะปัััะตะฝะฝัะน ะธะผะฟะพัั ั ัะพะทะดะฐะฝะธะตะผ ััััะบัััั
- **`GET /api/objects/analyze-excel`** - ะฐะฝะฐะปะธะท ััะฐะปะพะฝะฝะพะณะพ ัะฐะนะปะฐ

### **ะฃะปัััะตะฝะธั ะฒ ะบะพะดะต:**
- โ **ะัะฐะฒะธะปัะฝัะน ะฟะพััะดะพะบ ัะดะฐะปะตะฝะธั** ัะฒัะทะฐะฝะฝัั ะทะฐะฟะธัะตะน
- โ **ะะตัะฐะปัะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต** ะฒัะตั ะพะฟะตัะฐัะธะน
- โ **ะัะพะฒะตัะบะธ ัััะตััะฒะพะฒะฐะฝะธั** ะพะฑัะตะบัะพะฒ ะธ ัะฒัะทะตะน
- โ **Fallback ะผะตัะฐะฝะธะทะผั** ะดะปั ัะตัะบะฐัั
- โ **ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ** ะฟะตัะตะด ะธะผะฟะพััะพะผ

### **ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ:**
- โ **Graceful handling** ะพัะธะฑะพะบ ะพัะธััะบะธ
- โ **ะัะพะดะพะปะถะตะฝะธะต ะธะผะฟะพััะฐ** ะดะฐะถะต ะฟัะธ ะพัะธะฑะบะฐั ะพัะธััะบะธ
- โ **ะะตัะฐะปัะฝัะต ัะพะพะฑัะตะฝะธั** ะพะฑ ะพัะธะฑะบะฐั

## ๐ ะะะขะะะซะ ะคะฃะะะฆะะะะะ

### **ะงัะพ ะธัะฟัะฐะฒะปะตะฝะพ:**
- โ **ะัะฑะปะธะบะฐัั ะพะฑัะตะบัะพะฒ** - ะฐะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ ะฟะตัะตะด ะธะผะฟะพััะพะผ
- โ **ะะตะฟะพะปะฝะฐั ััััะบัััะฐ** - ัะพะทะดะฐะตััั ะฟะพะปะฝะฐั ะธะตัะฐััะธั
- โ **ะะตะฟัะฐะฒะธะปัะฝัะต ัะตัะบะฐััั** - ัะผะฝัะน ะฟะพะธัะบ ะฟะพะดัะพะดััะธั
- โ **ะััะฐัะบะธ ะฒ ะะ** - ะฟะพะปะฝะฐั ะพัะธััะบะฐ ะฒัะตั ัะฒัะทะตะน

### **ะงัะพ ัะฐะฑะพัะฐะตั:**
- โ **ะะพะฒัะพัะฝัะน ะธะผะฟะพัั** ัะพะณะพ ะถะต ัะฐะนะปะฐ ะฑะตะท ะพัะธะฑะพะบ
- โ **ะะพะปะฝะฐั ััััะบัััะฐ** ะพะฑัะตะบัะฐ ั ััะฐััะบะฐะผะธ, ะทะพะฝะฐะผะธ, ะฟะพะผะตัะตะฝะธัะผะธ
- โ **ะัะฐะฒะธะปัะฝัะต ัะตัะบะฐััั** ะดะปั ัะฑะพัะบะธ
- โ **ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟะพะธัะบ** ะธ ะฟัะธะฒัะทะบะฐ ะผะตะฝะตะดะถะตัะพะฒ
- โ **ะะตัะฐะปัะฝัะต ะพััะตัั** ะพ ะฟัะพัะตััะต

### **ะัะพัะตัั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั:**
1. **ะัะฑัะฐัั ัะฐะนะป Excel** ั ะดะฐะฝะฝัะผะธ ะพะฑัะตะบัะพะฒ
2. **ะะฐะถะฐัั "ะะฐะณััะทะธัั"** - ะพะดะธะฝ ะบะปะธะบ
3. **ะะพะปััะธัั ัะตะทัะปััะฐั** - ะฟะพะปะฝะพัะตะฝะฝัะต ะพะฑัะตะบัั ะณะพัะพะฒั ะบ ัะฐะฑะพัะต

**ะะธะบะฐะบะธั ะพัะธะฑะพะบ ะดัะฑะปะธะบะฐัะพะฒ, ะฟะพะปะฝะฐั ััััะบัััะฐ, ะฟัะฐะฒะธะปัะฝัะต ัะตัะบะฐััั!**

---

**ะะะะะะะะซ ะะะะะะขะ EXCEL ะะะจะะะซ!** ๐

ะขะตะฟะตัั ะธะผะฟะพัั ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ:
- ๐งน **ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ** ัััะตััะฒัััะธั ะพะฑัะตะบัะพะฒ
- ๐๏ธ **ะกะพะทะดะฐะฝะธะต ะฟะพะปะฝะพะน ััััะบัััั** ััะฐััะพะบ โ ะทะพะฝะฐ โ ะณััะฟะฟะฐ โ ะฟะพะผะตัะตะฝะธะต  
- ๐ **ะัะธะฒัะทะบะฐ ะฟัะฐะฒะธะปัะฝัั ัะตัะบะฐัั** ะดะปั ัะฑะพัะบะธ
- ๐ค **ะะพะธัะบ ะธ ะฝะฐะทะฝะฐัะตะฝะธะต ะผะตะฝะตะดะถะตัะพะฒ** ะธะท ะะ
- ๐ **ะะตัะฐะปัะฝะฐั ะพััะตัะฝะพััั** ะพ ะฟัะพัะตััะต
