# ÐÐžÐ’ÐÐ¯ ÐÐ Ð¥Ð˜Ð¢Ð•ÐšÐ¢Ð£Ð Ð Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ« Ð—ÐÐ”ÐÐ§

## ðŸŽ¯ ÐšÐžÐÐ¦Ð•ÐŸÐ¦Ð˜Ð¯: Ð›Ð•ÐÐ˜Ð’ÐžÐ• Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• Ð—ÐÐ”ÐÐ§

### ðŸ“Š Ð¡Ð¢Ð Ð£ÐšÐ¢Ð£Ð Ð Ð”ÐÐÐÐ«Ð¥

#### 1ï¸âƒ£ Ð¢Ð•Ð¥ÐšÐÐ Ð¢Ð« (Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¸ÑÑ‚Ð¸Ð½Ñ‹)
```
TechCard {
  id, name, description, frequency, objectId, roomId
  // Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð’Ð¡Ð® Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ðµ
}
```

#### 2ï¸âƒ£ Ð’Ð˜Ð Ð¢Ð£ÐÐ›Ð¬ÐÐ«Ð• Ð—ÐÐ”ÐÐ§Ð˜ (Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÑŽÑ‚ÑÑ)
```javascript
// ÐÐµ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð² Ð‘Ð”, Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð½Ð° Ð»ÐµÑ‚Ñƒ
VirtualTask {
  id: `${techCardId}-${date}`,
  techCard: TechCard,
  scheduledDate: Date,
  status: calculateStatus(techCard, date),
  isOverdue: checkOverdue(techCard, date)
}
```

#### 3ï¸âƒ£ Ð Ð•ÐÐ›Ð¬ÐÐ«Ð• Ð—ÐÐ”ÐÐ§Ð˜ (ÑÐ¾Ð·Ð´Ð°ÑŽÑ‚ÑÑ Ð¿Ð¾ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑŽ)
```
Task {
  id, techCardId, date, status, 
  completionComment, completionPhotos,
  completedAt, completedById
  // Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¸
}
```

### ðŸ”§ ÐšÐžÐÐ¢Ð ÐžÐ›Ð¬ÐÐÐ¯ Ð¤Ð£ÐÐšÐ¦Ð˜Ð¯

```javascript
function calculateTaskStatus(techCard, date) {
  const now = new Date();
  const taskDate = new Date(date);
  
  // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐµÑÑ‚ÑŒ Ð»Ð¸ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°
  const realTask = await Task.findUnique({
    where: { techCardId_date: { techCardId, date } }
  });
  
  if (realTask) {
    return realTask.status; // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ
  }
  
  // Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ
  if (taskDate > now) return 'PENDING';
  if (isSameDay(taskDate, now)) return 'AVAILABLE';
  if (taskDate < now) return 'OVERDUE';
}
```

### ðŸš€ ÐÐ›Ð“ÐžÐ Ð˜Ð¢Ðœ Ð ÐÐ‘ÐžÐ¢Ð«

#### 1ï¸âƒ£ ÐžÐ¢ÐžÐ‘Ð ÐÐ–Ð•ÐÐ˜Ð• ÐšÐÐ›Ð•ÐÐ”ÐÐ Ð¯
```javascript
// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚ÐµÑ…ÐºÐ°Ñ€Ñ‚Ñ‹
const techCards = await TechCard.findMany();

// Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð´Ð»Ñ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°
const virtualTasks = generateVirtualTasks(techCards, dateRange);

// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð´Ð»Ñ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°
const realTasks = await Task.findMany({ where: { date: { in: dateRange } } });

// ÐžÐ±ÑŠÐµÐ´Ð¸Ð½ÑÐµÐ¼ (Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐºÑ€Ñ‹Ð²Ð°ÑŽÑ‚ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ)
const tasks = mergeVirtualAndReal(virtualTasks, realTasks);
```

#### 2ï¸âƒ£ Ð’Ð—ÐÐ˜ÐœÐžÐ”Ð•Ð™Ð¡Ð¢Ð’Ð˜Ð• Ð¡ Ð—ÐÐ”ÐÐ§Ð•Ð™
```javascript
async function interactWithTask(techCardId, date, action) {
  // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ€ÐµÐ°Ð»ÑŒÐ½ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ ÐµÑÐ»Ð¸ ÐµÑ‘ Ð½ÐµÑ‚
  let task = await Task.findUnique({
    where: { techCardId_date: { techCardId, date } }
  });
  
  if (!task) {
    task = await Task.create({
      data: {
        techCardId,
        date,
        status: 'IN_PROGRESS'
      }
    });
  }
  
  // Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ
  return await performAction(task, action);
}
```

## âœ… ÐŸÐ Ð•Ð˜ÐœÐ£Ð©Ð•Ð¡Ð¢Ð’Ð ÐÐžÐ’ÐžÐ“Ðž ÐŸÐžÐ”Ð¥ÐžÐ”Ð

### ðŸŽ¯ ÐŸÐ ÐžÐ˜Ð—Ð’ÐžÐ”Ð˜Ð¢Ð•Ð›Ð¬ÐÐžÐ¡Ð¢Ð¬
- **ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð² Ð‘Ð”** - Ð·Ð°Ð´Ð°Ñ‡Ð¸ ÑÐ¾Ð·Ð´Ð°ÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸
- **Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ** - ÑÑ‚Ð°Ñ‚ÑƒÑÑ‹ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð½Ð° Ð»ÐµÑ‚Ñƒ
- **ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾ÑÑ‚ÑŒ** - ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð½Ðµ Ñ‚Ð¾Ñ€Ð¼Ð¾Ð·Ð¸Ñ‚ Ð¿Ñ€Ð¸ Ñ€Ð¾ÑÑ‚Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²

### ðŸ”„ Ð“Ð˜Ð‘ÐšÐžÐ¡Ð¢Ð¬
- **Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ñ‚ÐµÑ…ÐºÐ°Ñ€Ñ‚** Ð¼Ð³Ð½Ð¾Ð²ÐµÐ½Ð½Ð¾ Ð¾Ñ‚Ñ€Ð°Ð¶Ð°ÑŽÑ‚ÑÑ Ð² ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€Ðµ
- **ÐÐ¾Ð²Ñ‹Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹** ÑÑ€Ð°Ð·Ñƒ Ð²Ð¸Ð´Ð½Ñ‹ Ð±ÐµÐ· ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡
- **ÐŸÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ** Ð»ÐµÐ³ÐºÐ¾ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ

### ðŸ›¡ï¸ ÐÐÐ”Ð•Ð–ÐÐžÐ¡Ð¢Ð¬
- **Ð•Ð´Ð¸Ð½Ñ‹Ð¹ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¸ÑÑ‚Ð¸Ð½Ñ‹** - Ñ‚ÐµÑ…ÐºÐ°Ñ€Ñ‚Ñ‹
- **ÐÐµÑ‚ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ** Ð´Ð°Ð½Ð½Ñ‹Ñ…
- **ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ**

### ðŸ’¾ Ð­ÐšÐžÐÐžÐœÐ˜Ð¯ Ð Ð•Ð¡Ð£Ð Ð¡ÐžÐ’
- **Ð’Ð¼ÐµÑÑ‚Ð¾ 3,754 Ð·Ð°Ð´Ð°Ñ‡** â†’ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð´ÐµÑÑÑ‚ÐºÐ¾Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ…
- **ÐœÐµÐ½ÑŒÑˆÐµ Ð¼ÐµÑÑ‚Ð° Ð² Ð‘Ð”**
- **Ð‘Ñ‹ÑÑ‚Ñ€ÐµÐµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ**

## ðŸ”§ Ð Ð•ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð¯

### API Ð­ÐÐ”ÐŸÐžÐ˜ÐÐ¢Ð«
```
GET /api/tasks/virtual/{date} - Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° Ð´Ð°Ñ‚Ñƒ
POST /api/tasks/materialize - ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ€ÐµÐ°Ð»ÑŒÐ½ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ Ð¸Ð· Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹
PUT /api/tasks/{id}/complete - Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ñƒ (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ ÐµÑÐ»Ð¸ Ð½ÐµÑ‚)
POST /api/tasks/{id}/comment - Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ ÐµÑÐ»Ð¸ Ð½ÐµÑ‚)
```

### ÐšÐžÐœÐŸÐžÐÐ•ÐÐ¢Ð«
- `VirtualTaskCalculator` - Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡
- `TaskMaterializer` - ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡ Ð¿Ð¾ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑŽ
- `StatusCalculator` - Ñ€Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ¾Ð² Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

## ðŸŽ¯ Ð Ð•Ð—Ð£Ð›Ð¬Ð¢ÐÐ¢

### Ð”Ðž (Ñ‚ÐµÐºÑƒÑ‰Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°):
- 3,754 Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ð‘Ð” Ð½Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ
- Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- ÐžÑˆÐ¸Ð±ÐºÐ¸ "Ð·Ð°Ð´Ð°Ñ‡Ð° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°"

### ÐŸÐžÐ¡Ð›Ð• (Ð½Ð¾Ð²Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°):
- ~10-50 Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡ Ð² Ð‘Ð” (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸ÐµÐ¼)
- Ð•Ð´Ð¸Ð½Ñ‹Ð¹ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¸ÑÑ‚Ð¸Ð½Ñ‹
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ
- ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð¿Ð¾Ð¸ÑÐºÐ°

## ðŸš€ ÐŸÐ›ÐÐ ÐœÐ˜Ð“Ð ÐÐ¦Ð˜Ð˜

1. **Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ API** Ð´Ð»Ñ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡
2. **ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´** Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸
3. **Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ** Ð¿Ñ€Ð¸ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¸
4. **ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ** Ð½Ð¾Ð²ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ
5. **ÐœÐ¸Ð³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ** Ð¸ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸
6. **ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ð‘Ð”** Ð¾Ñ‚ Ð»Ð¸ÑˆÐ½Ð¸Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹

Ð’Ð°Ñˆ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ **Ð—ÐÐÐ§Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð›Ð£Ð§Ð¨Ð•** Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð·Ñ€ÐµÐ½Ð¸Ñ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹, Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ð½Ð°Ð´ÐµÐ¶Ð½Ð¾ÑÑ‚Ð¸!
